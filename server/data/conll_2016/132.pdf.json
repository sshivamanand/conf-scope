{
  "name" : "132.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Mixing Dirichlet Topic Models and Word Embeddings to Make lda2vec",
    "authors" : [ ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "1 000\n011\n012\n013\n014\n015\n016\n017\n018\n019\n020\n021\n022\n023\n024\n025\n026\n027\n028\n029\n030\n031\n032\n033\n034\n035\n036\n037\n038\n039\n040\n041\n042\n043\n044\n045\n046\n047\n048\n049\n061\n062\n063\n064\n065\n066\n067\n068\n069\n070\n071\n072\n073\n074\n075\n076\n077\n078\n079\n080\n081\n082\n083\n084\n085\n086\n087\n088\n089\n090\n091\n092\n093\n094\n095\n096\n097\n098\n099"
    }, {
      "heading" : "1 Introduction",
      "text" : "Topic models are popular for their ability to organize document collections into a smaller set of prominent themes. In contrast to dense distributed representations, these document and topic representations are generally accessible to humans and more easily lend themselves to being interpreted. This interpretability provides additional options to highlight the patterns and structures within our systems of documents. For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al., 2015). See Blei et al. (2010) for an overview of topic modelling in do-\nmains as diverse as computer vision, genetic markers, survey data, and social network data.\nDense vector approaches to building document representations also exist: Le and Mikolov (2014) propose paragraph vectors that are predictive of bags of words within paragraphs, Kiros et al. (2015) build vectors that reconstruct the sentence sequences before and after a given sentence, and Ghosh et al. (2016) construct contextual LSTMs that predict proceeding sentence features. Probabilistic topic models tend to form documents as a sparse mixed-membership of topics while neural network models tend to model documents as dense vectors. By virtue of both their sparsity and low-dimensionality, representations from the former are simpler to inspect and more immediately yield high level intuitions about the underlying system (although not without hazards, see Chang et al. (2009)). This paper explores hybrid approaches mixing sparse document representations with dense word and topic vectors.\nUnfortunately, crafting a new probabilistic topic model requires deriving a new approximation, a procedure which takes substantial expertise and must be customized to every model. As a result, prototypes are time-consuming to develop and changes to model architectures must be carefully considered. However, with modern automatic differentiation frameworks the practitioner can focus development time on the model design rather than the model approximations. This expedites the process of evaluating which model features are relevant. This work takes advantage of the Chainer (Tokui et al., 2015) framework to quickly develop models while also enabling us to utilize GPUs to dramatically improve computational speed.\nFinally, traditional topic models over text do not take advantage of recent advances in distributed word representations which can capture semantically meaningful regularities between tokens. The\n2\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\n190\n191\n192\n193\n194\n195\n196\n197\n198\n199\n0.34 -0.1 0.17\n41% 26% 34%\n-1.4 -0.5 -1.4\n-1.9-1.7 0.75\n0.96-0.7 -1.9\n-0.2-1.1 0.6\n-1.2-1.2 -0.2\n-0.7 -0.4 -0.7 -0.3 -0.3-1.9 0.85 -0.6 -0.3 -0.5\n-2.6 0.45 -1.3 -0.6 -0.8\nsally said the fox jumped over the\nsally said the fox jumped over the\n#topics\n#topics\nfox\n# hidden units\n#topics\n#hidden units#hidden units\n#hidden units\nSkip grams from sentences\n34% 32% 34%\nt=0\nWord vector\nNegative sampling loss\nTopic matrix\nDocument proportion\nDocument weight\nDocument vector\nContext vector\nSparse document proportions\nx\n+\n41% 26% 34%\nt=10\n99% 1% 0%\nt=∞\ntime\nFigure 1: lda2vec builds representations over both words and documents by mixing word2vec’s skipgram architecture with Dirichlet-optimized sparse topic mixtures. The various components and transformations present in the diagram are described in the text.\nexamination of word co-occurrences has proven to be a fruitful research paradigm. For example, Mikolov et al. (2013) utilize Skipgram NegativeSampling (SGNS) to train word embeddings using word-context pairs formed from windows moving across a text corpus. These vector representations ultimately encode remarkable linearities such as king − man + woman = queen. In fact, Levy and Goldberg (2014c) demonstrate that this is implicitly factorizing a variant of the Pointwise Mutual Information (PMI) matrix that emphasizes predicting frequent co-occurrences over rare ones. Closely related to the PMI matrix, Pennington et al. (2014) factorize a large global word count co-occurrence matrix to yield more efficient and slightly more performant computed embeddings than SGNS. Once created, these representations are then useful for information retrieval (Manning et al., 2009) and parsing tasks (Levy and Goldberg, 2014a). In this work, we will take advantage of word-level representations to build document-level abstractions.\nThis paper extends distributed word representations by including interpretable document representations and demonstrate that model inference can be performed and extended within the framework of automatic differentiation."
    }, {
      "heading" : "2 Model",
      "text" : "This section describes the model for lda2vec. We are interested in modifying the Skipgram Negative-Sampling (SGNS) objective in (Mikolov et al., 2013) to utilize document-wide feature vectors while simultaneously learning continuous document weights loading onto topic vectors. The network architecture is shown in Figure 1.\nThe total loss term L in (1) is the sum of the Skipgram Negative Sampling Loss (SGNS) Lnegij with the addition of a Dirichlet-likelihood term over document weights, Ld that will be discussed later. The loss is conducted using a context vector, ~cj , pivot word vector ~wj , target word vector ~wi, and negatively-sampled word vector ~wl.\nL = Ld + ΣijLnegij (1) Lnegij = log σ(~cj · ~wi) + Σ n l=0 log σ(−~cj · ~wl)\n(2)"
    }, {
      "heading" : "2.1 Word Representation",
      "text" : "As in Mikolov et al. (2013), pairs of pivot and target words (j, i) are extracted when they co-\n3\n201\n202\n203\n204\n205\n206\n207\n208\n209\n210\n211\n212\n213\n214\n215\n216\n217\n218\n219\n220\n221\n222\n223\n224\n225\n226\n227\n228\n229\n230\n231\n232\n233\n234\n235\n236\n237\n238\n239\n240\n241\n242\n243\n244\n245\n246\n247\n248\n249\n250\n251\n252\n253\n254\n255\n256\n257\n258\n259\n260\n261\n262\n263\n264\n265\n266\n267\n268\n269\n270\n271\n272\n273\n274\n275\n276\n277\n278\n279\n280\n281\n282\n283\n284\n285\n286\n287\n288\n289\n290\n291\n292\n293\n294\n295\n296\n297\n298\n299\noccur in a moving window scanning across the corpus. In our experiments, the window contains five tokens before and after the pivot token. For every pivot-target pair of words the pivot word is used to predict the nearby target word. Each word is represented with a fixedlength dense distributed-representation vector, but unlike Mikolov et al. (2013) the same word vectors are used in both the pivot and target representations. The SGNS loss shown in (2) attempts to discriminate context-word pairs that appear in the corpus from those randomly sampled from a ‘negative’ pool of words. This loss is minimized when the observed words are completely separated from the marginal distribution. The distribution from which tokens are drawn is uβ , where u denotes the overall word frequency normalized by the total corpus size. Unless stated otherwise, the negative sampling power beta is set to 3/4 and the number of negative samples is fixed to n = 15 as in Mikolov et al. (2013). Note that a distribution of u0.0 would draw negative tokens from the vocabulary with no notion of popularity while a distribution proportional with u1.0 draws from the empirical unigram distribution. Compared to the unigram distribution, the choice of u3/4 slightly emphasizes choosing infrequent words for negative samples. In contrast to optimizing the softmax cross entropy, which requires modelling the overall popularity of each token, negative sampling focuses on learning word vectors conditional on a context by drawing negative samples from each token’s marginal popularity in the corpus."
    }, {
      "heading" : "2.2 Document Representations",
      "text" : "lda2vec embeds both words and document vectors into the same space and trains both representations simultaneously. By adding the pivot and document vectors together, both spaces are effectively joined. Mikolov et al. (2013) provide the intuition that word vectors can be summed together to form a semantically meaningful combination of both words. For example, the vector representation for Germany + airline is similar to the vector for Lufthansa. We would like to exploit the additive property of word vectors to construct a meaningful sum of word and document vectors. For example, if as lda2vec is scanning a document the jth word is Germany, then neighboring words are predicted to be similar such as France, Spain, and Austria. But if the document is specifically\nabout airlines, then we would like to construct a document vector similar to the word vector for airline. Then instead of predicting tokens similar to Germany alone, predictions similar to both the document and the pivot word can be made such as: Lufthansa, Condor F lugdienst, and Aero Lloyd. Motivated by the meaningful sums of words vectors, in lda2vec the context vector is explicitly designed to be the sum of a document vector and a word vector as in (3):\n~cj = ~wj + ~dj (3)\nThis models document-wide relationships by preserving ~dj for all word-context pairs in a document, while still leveraging local inter-word relationships stemming from the interaction between the pivot word vector ~wj and target word ~wi. The document and word vectors are summed together to form a context vector that intuitively captures long- and short-term themes, respectively. In order to prevent co-adaptation, we also perform dropout on both the unnormalized document vector ~dj and the pivot word vector ~wj (Hinton et al., 2012)."
    }, {
      "heading" : "2.2.1 Document Mixtures",
      "text" : "If we only included structure up to this point, the model would produce a dense vector for every document. However, lda2vec strives to form interpretable representations and to do so an additional constraint is imposed such that the document representations are similar to those in traditional LDA models. We aim to generate a document vector from a mixture of topic vectors and to do so, we begin by constraining the document vector ~dj to project onto a set of latent topic vectors ~t0, ~t1, ..., ~tk:\n~dj = pj0·~t0+pj1·~t1+...+pjk·~tk+...+pjn·~tn (4)\nEach weight 0 ≤ pjk ≤ 1 is a fraction that denotes the membership of document j in the topic k. For example, the Twenty Newsgroups model described later has 11313 documents and n = 20 topics so j = 0...11312, k = 0...19. When the word vector dimension is set to 300, it is assumed that the document vectors ~dj , word vectors ~wi and topic vectors ~tk all have dimensionality 300. Note that the topics ~tk are shared and are a common component to all documents but whose strengths are modulated by document weights pjk that are\n4\n301\n302\n303\n304\n305\n306\n307\n308\n309\n310\n311\n312\n313\n314\n315\n316\n317\n318\n319\n320\n321\n322\n323\n324\n325\n326\n327\n328\n329\n330\n331\n332\n333\n334\n335\n336\n337\n338\n339\n340\n341\n342\n343\n344\n345\n346\n347\n348\n349\n350\n351\n352\n353\n354\n355\n356\n357\n358\n359\n360\n361\n362\n363\n364\n365\n366\n367\n368\n369\n370\n371\n372\n373\n374\n375\n376\n377\n378\n379\n380\n381\n382\n383\n384\n385\n386\n387\n388\n389\n390\n391\n392\n393\n394\n395\n396\n397\n398\n399\nunique to each document. To aid interpretability, the document memberships are designed to be non-negative, and to sum to unity. To achieve this constraint, a softmax transform maps latent vectors initialized in R300 onto the simplex defined by pjk. The softmax transform naturally enforces the constraint that Σkpjk = 1 and allows us interpret memberships as percentages rather than unbounded weights.\nFormulating the mixture in (4) as a sum ensures that topic vectors ~tk, document vectors ~dj and word vectors ~wi, operate in the same space. As a result, what words ~wi are most similar to any given topic vector ~tk can be directly calculated. While each topic is not literally a token present in the corpus, it’s similarity to other tokens is meaningful and can be measured. Furthermore, by examining the list of most similar words one can attempt to interpret what the topic represents. For example, by calculating the most similar token to any topic vector (e.g. argmaxi(~t0 · ~wi)) one may discover that the first topic vector ~t0 is similar to the tokens pitching, catcher, and Braves while the second topic vector ~t1 may be similar to Jesus, God, and faith. This provides us the option to interpret the first topic as baseball topic, and as a result the first component in every document proportion pj0 indicates how much document j is in the baseball topic. Similarly, the second topic may be interpreted as Christianity and the second component of any document proportion pj1 indicates the membership of that document in the Christianity topic."
    }, {
      "heading" : "2.2.2 Sparse Memberships",
      "text" : "Finally, the document weights pij are sparsified by optimizing the document weights with respect to a Dirichlet likelihood with a low concentration parameter α:\nLd = λΣjk (α− 1) log pjk (5)\nThe overall objective in (5) measures the likelihood of document j in topic k summed over all available documents. The strength of this term is modulated by the tuning parameter λ. This simple likelihood encourages the document proportions coupling in each topic to be sparse when α < 1 and homogeneous when α > 1. To drive interpretability, we are interested in finding sparse memberships and so set α = n−1 where n is the number of topics. We also find that setting\nthe overall strength of the Dirichlet optimization to λ = 200 works well. Document proportions are initialized to be relatively homogeneous, but as time progresses, the Ld encourages document proportions vectors to become more concentrated (e.g. sparser) over time. In experiments without this sparsity-inducing term (or equivalently when α = 1) the document weights pij tend to have probability mass spread out among all elements. Without any sparsity inducing terms the existence of so many non-zero weights makes interpreting the document vectors difficult. Furthermore, we find that the topic basis are also strongly affected, and the topics become incoherent."
    }, {
      "heading" : "2.3 Preprocessing and Training",
      "text" : "The objective in (1) is trained in individual minibatches at a time while using the Adam optimizer (Kingma and Ba, 2014) for two hundred epochs across the dataset. The Dirichlet likelihood term Ld is typically computed over all documents, so in modifying the objective to minibatches we adjust the loss of the term to be proportional to the minibatch size divided by the size of the total corpus. Our software is open source, available online, documented and unit tested1. Finally, the top ten most likely words in a given topic are submitted to the online Palmetto2 topic quality measuring tool and the coherence measure Cv is recorded. After evaluating multiple alternatives, Cv is the recommended coherence metric in Röder et al. (2015). This measure averages the Normalized Pointwise Mutual Information (NPMI) for every pair of words within a sliding window of size 110 on an external corpus and returns mean of the NPMI for the submitted set of words. Token-toword similarity is evaluated using the 3COSMUL measure (Levy and Goldberg, 2014b)."
    }, {
      "heading" : "3 Experiments",
      "text" : ""
    }, {
      "heading" : "3.1 Twenty Newsgroups",
      "text" : "This section details experiments in discovering the salient topics in the Twenty Newsgroups dataset, a popular corpus for machine learning on text. Each document in the corpus was posted to one of twenty possible newsgroups. While the text of each post is available to lda2vec, each of the\n1The code for lda2vec is available online at https:// github.com/cemoody/lda2vec\n2The online evaluation tool can be accessed at http:// palmetto.aksw.org/palmetto-webapp/\n5\n401\n402\n403\n404\n405\n406\n407\n408\n409\n410\n411\n412\n413\n414\n415\n416\n417\n418\n419\n420\n421\n422\n423\n424\n425\n426\n427\n428\n429\n430\n431\n432\n433\n434\n435\n436\n437\n438\n439\n440\n441\n442\n443\n444\n445\n446\n447\n448\n449\n450\n451\n452\n453\n454\n455\n456\n457\n458\n459\n460\n461\n462\n463\n464\n465\n466\n467\n468\n469\n470\n471\n472\n473\n474\n475\n476\n477\n478\n479\n480\n481\n482\n483\n484\n485\n486\n487\n488\n489\n490\n491\n492\n493\n494\n495\n496\n497\n498\n499\n# of topics β Topic Coherences 20 0.75 0.567 30 0.75 0.555 40 0.75 0.553 50 0.75 0.547 20 1.00 0.563 30 1.00 0.564 40 1.00 0.552 50 1.00 0.558\nFigure 2: Average topic coherences found by lda2vec in the Twenty Newsgroups dataset are given. The topic coherence has been demonstrated to correlate with human evaluations of topic models (Röder et al., 2015). The number of topics chosen is given, as well as the negative sampling exponent parameter β. Compared to β = 1.00, β = 0.75 draws more rare words as negative samples. The best topic coherences are found in models n = 20 topics and a β = 0.75.\nnewsgroup partitions is not revealed to the algorithm but is nevertheless useful for post-hoc qualitative evaluations of the discovered topics. The corpus is preprocessed using the data loader available in Scikit-learn (Pedregosa et al., 2012) and tokens are identified using the SpaCy parser (Honnibal and Johnson, 2015). Words are lemmatized to group multiple inflections into single tokens. Tokens that occur fewer than ten times in the corpus are removed, as are tokens that appear to be URLs, numbers or contain special symbols within their orthographic forms. After preprocessing, the dataset contains 1.8 million observations of 8,946 unique tokens in 11,313 documents. Word vectors are initialized to the pretrained values found in Mikolov et al. (2013) but otherwise updates are allowed to these vectors at training time.\nA range of lda2vec parameters are evaluated by varying the number of topics n ∈ 20, 30, 40, 50 and the negative sampling exponent β ∈ 0.75, 1.0. The best topic coherences were achieved with n = 20 topics and with negative sampling power β = 0.75 as summarized in Figure 2. We briefly experimented with variations on dropout ratios but we did not observe any substantial differences.\nFigure 3 lists four example topics discovered in the Twenty Newsgroups dataset. Each topic is associated with a topic vector that lives in the same space as the trained word vectors and listed are the most similar words to each topic vector. The\nfirst topic shown has high similarity to the tokens astronomical, Astronomy, satellite, planetary, and telescope and is thus likely a ‘Space’-related topic similar to the ‘sci.space’ newsgroup. The second example topic is similar to words semantically related to ‘Encryption’, such as Clipper and encrypt, and is likely related to the ‘sci.crypt’ newsgroup. The third and four example topics are ‘X Windows’ and ‘Middle East’ which likely belong to the ‘comp.windows.x’ and ‘talk.politics.mideast’ newsgroups."
    }, {
      "heading" : "3.2 Hacker News Comments corpus",
      "text" : "This section evaluates lda2vec on a very large corpus of Hacker News 3 comments. Hacker News is social content-voting website and community whose focus is largely on technology and entrepreneurship. In this corpus, a single document is composed of all of the words in all comments posted to a single article. Only stories with more than 10 comments are included, and only comments from users with more than 10 comments are included. We ignore other metadata such as votes, timestamps, and author identities. The raw dataset 4 is available for download online. The corpus is nearly fifty times the size of the Twenty Newsgroups corpus which is sufficient for learning a specialized vocabulary. To take advantage of this rich corpus, we use the SpaCy to tokenize whole noun phrases and entities at once (Honnibal and Johnson, 2015). The specific tokenization procedure5 is also available online, as are the preprocessed datasets 6 results. This allows us to capture phrases such as community policing measure and prominent figures such as Steve Jobs as single tokens. However, this tokenization procedure generates a vocabulary substantially different from the one available in the Palmetto topic coherence tool and so we do not report topic coherences on this corpus. After preprocessing, the corpus contains 75 million tokens in 66 thousand documents with 110 thousand unique tokens. Unlike the Twenty Newsgroups analysis, word vectors are initialized randomly instead of using a library of pretrained vectors.\n3See https://news.ycombinator.com/ 4The raw dataset is freely available at https:// zenodo.org/record/45901 5The tokenization procedure is available online at https://github.com/cemoody/lda2vec/blob/ master/lda2vec/preprocess.py\n6A tokenized dataset is freely available at https:// zenodo.org/record/49899\n6\n501\n502\n503\n504\n505\n506\n507\n508\n509\n510\n511\n512\n513\n514\n515\n516\n517\n518\n519\n520\n521\n522\n523\n524\n525\n526\n527\n528\n529\n530\n531\n532\n533\n534\n535\n536\n537\n538\n539\n540\n541\n542\n543\n544\n545\n546\n547\n548\n549\n550\n551\n552\n553\n554\n555\n556\n557\n558\n559\n560\n561\n562\n563\n564\n565\n566\n567\n568\n569\n570\n571\n572\n573\n574\n575\n576\n577\n578\n579\n580\n581\n582\n583\n584\n585\n586\n587\n588\n589\n590\n591\n592\n593\n594\n595\n596\n597\n598\n599\nTopic Label “Space” “Encryption” “X Windows” “Middle East” Top tokens astronomical encryption mydisplay Armenian\nAstronomy wiretap xlib Lebanese satellite encrypt window Muslim planetary escrow cursor Turk telescope Clipper pixmap sy\nTopic Coherence 0.712 0.675 0.472 0.615\nFigure 3: Topics discovered by lda2vec in the Twenty Newsgroups dataset. The inferred topic label is shown in the first row. The tokens with highest similarity to the topic are shown immediately below. Note that the twenty newsgroups corpus contains corresponding newsgroups such as sci.space, sci.crypt, comp.windows.x and talk.politics.mideast.\n“Housing Issues” “Internet Portals” “Bitcoin” “Compensation” “Gadget Hardware” more housing DDG. btc current salary the Surface Pro basic income Bing bitcoins more equity HDMI new housing Google+ Mt. Gox vesting glossy screens house prices DDG MtGox equity Mac Pro short-term rentals iGoogle Gox vesting schedule Thunderbolt\nFigure 4: Topics discovered by lda2vec in the Hacker News comments dataset. The inferred topic label is shown in the first row. We form tokens from noun phrases to capture the unique vocabulary of this specialized corpus.\nArtificial sweeteners\nBlack holes Comic Sans Functional Programming San Francisco\nglucose particles typeface FP New York fructose consciousness Arial Haskell Palo Alto HFCS galaxies Helvetica OOP NYC sugars quantum mechanics Times New Roman functional languages New York City sugar universe font monads SF Soylent dark matter new logo Lisp Mountain View paleo diet Big Bang Anonymous Pro Clojure Seattle diet planets Baskerville category theory Los Angeles carbohydrates entanglement serif font OO Boston\nFigure 5: Given an example token in the top row, the most similar words available in the Hacker News comments corpus are reported.\n7\n601\n602\n603\n604\n605\n606\n607\n608\n609\n610\n611\n612\n613\n614\n615\n616\n617\n618\n619\n620\n621\n622\n623\n624\n625\n626\n627\n628\n629\n630\n631\n632\n633\n634\n635\n636\n637\n638\n639\n640\n641\n642\n643\n644\n645\n646\n647\n648\n649\n662\n663\n664\n665\n666\n667\n668\n669\n670\n671\n672\n673\n674\n675\n676\n677\n678\n679\n680\n681\n682\n683\n684\n685\n686\n687\n688\n689\n690\n691\n692\n693\n694\n695\n696\n697\n698\n699\nWe train an lda2vec model using 40 topics and 256 hidden units and report the learned topics that demonstrate the themes present in the corpus. Furthermore, we demonstrate that word vectors and semantic relationships specific to this corpus are learned.\nIn Figure 4 five example topics discovered by lda2vec in the Hacker News corpus are listed. These topics demonstrate that the major themes of the corpus are reproduced and represented in learned topic vectors in a similar fashion as in LDA (Blei et al., 2003). The first, which we hand-label Housing Issues has prominent tokens relating to housing policy issues such as housing supply (e.g. more housing), and costs (e.g. basic income and house prices). Another topic lists major internet portals, such as the privacyconscious search engine ‘Duck Duck Go’ (in the corpus abbreviated as DDG), as well as other major search engines (e.g. Bing), and home pages (e.g. Google+, and iGoogle). A third topic is that of the popular online curency and payment system Bitcoin, the abbreviated form of the currency btc, and the now-defunct Bitcoin trading platform Mt. Gox. A fourth topic considers salaries and compensation with tokens such as current salary, more equity and vesting, the process by which employees secure stock from their employers. A fifth example topic is that of technological hardware like HDMI and glossy screens and includes devices such as the Surface Pro and Mac Pro.\nFigure 5 demonstrates that token similarities are learned in a similar fashion as in SGNS (Mikolov et al., 2013) but specialized to the Hacker News corpus. Tokens similar to the token Artificial sweeteners include other sugar-related tokens like fructose and food-related tokens such as paleo diet. Tokens similar to Black holes include physics-related concepts such as galaxies and dark matter. The Hacker News corpus devotes a substantial quantity of text to fonts and design, and the words most similar to Comic Sans are other popular fonts (e.g. Times New Roman and Helvetica) as well as font-related concepts such as typeface and serif font. Tokens similar to Functional Programming demonstrate similarity to other computer science-related tokens while tokens similar to San Francisco include other large American cities as well smaller cities located in the San Francisco Bay Area.\nFigure 6 demonstrates that in addition to learn-\ning topics over documents and similarities to word tokens, linear regularities between tokens are also learned. The ‘Query’ column lists a selection of tokens that when combined yield a token vector closest to the token shown in the ‘Result’ column. The subtractions and additions of vectors are evaluated literally, but instead take advantage of the 3COSMUL objective (Levy and Goldberg, 2014b). The results show that relationships between tokens important to the Hacker News community exists between the token vectors. For example, the vector for Silicon Valley is similar to both California and technology, Bitcoin is indeed a digital currency, Node.js is a technology that enables running Javascript on servers instead of on clientside browsers, Jeff Bezos and Mark Zuckerberg are CEOs of Amazon and Facebook respectively, NLP and computer vision are fields of machine learning research primarily dealing with text and images respectively, Edward Snowden and Julian Assange are both whistleblowers who were primarily located in the United States and Sweden and finally the Kindle and the Surface Pro are both tablets manufactured by Amazon and Microsoft respectively. In the above examples semantic relationships between tokens encode for attributes and features including: location, currencies, server v.s. client, leadership figures, machine learning fields, political figures, nationalities, companies and hardware.\n8\n701\n702\n703\n704\n705\n706\n707\n708\n709\n710\n711\n712\n713\n714\n715\n716\n717\n718\n719\n720\n721\n722\n723\n724\n725\n726\n727\n728\n729\n730\n731\n732\n733\n734\n735\n736\n737\n738\n739\n740\n741\n742\n743\n744\n745\n746\n747\n748\n749\n750\n751\n752\n753\n754\n755\n756\n757\n758\n759\n760\n761\n762\n763\n764\n765\n766\n767\n768\n769\n770\n771\n772\n773\n774\n775\n776\n777\n778\n779\n780\n781\n782\n783\n784\n785\n786\n787\n788\n789\n790\n791\n792\n793\n794\n795\n796\n797\n798\n799"
    }, {
      "heading" : "3.3 Conclusion",
      "text" : "This work demonstrates a simple model, lda2vec, that extends SGNS (Mikolov et al., 2013) to build unsupervised document representations that yield coherent topics. Word, topic, and document vectors are jointly trained and embedded in a common representation space that preserves semantic regularities between the learned word vectors while still yielding sparse and interpretable documentto-topic proportions in the style of LDA (Blei et al., 2003). Topics formed in the Twenty Newsgroups corpus yield high mean topic coherences which have been shown to correlate with human evaluations of topics (Röder et al., 2015). When applied to a Hacker News comments corpus, lda2vec discovers the salient topics within this community and learns linear relationships between words that allow it solve word analogies in the specialized vocabulary of this corpus. Finally, we note that our method is simple to implement in automatic differentiation frameworks and can lead to more readily interpretable unsupervised representations."
    } ],
    "references" : [ {
      "title" : "Latent dirichlet allocation",
      "author" : [ "David M Blei", "Andrew Y Ng", "Michael I Jordan." ],
      "venue" : "The Journal of Machine Learning Research, 3:993–1022, March.",
      "citeRegEx" : "Blei et al\\.,? 2003",
      "shortCiteRegEx" : "Blei et al\\.",
      "year" : 2003
    }, {
      "title" : "Probabilistic Topic Models",
      "author" : [ "David Blei", "Lawrence Carin", "David Dunson." ],
      "venue" : "IEEE Signal Processing Magazine, 27(6):55–65.",
      "citeRegEx" : "Blei et al\\.,? 2010",
      "shortCiteRegEx" : "Blei et al\\.",
      "year" : 2010
    }, {
      "title" : "Reading tea leaves: How humans interpret topic models",
      "author" : [ "J Chang", "S Gerrish", "C Wang." ],
      "venue" : "Advances in . . . .",
      "citeRegEx" : "Chang et al\\.,? 2009",
      "shortCiteRegEx" : "Chang et al\\.",
      "year" : 2009
    }, {
      "title" : "Dynamic Poisson Factorization",
      "author" : [ "Laurent Charlin", "Rajesh Ranganath", "James McInerney", "David M Blei." ],
      "venue" : "ACM, September.",
      "citeRegEx" : "Charlin et al\\.,? 2015",
      "shortCiteRegEx" : "Charlin et al\\.",
      "year" : 2015
    }, {
      "title" : "Contextual LSTM (CLSTM) models for Large scale NLP tasks",
      "author" : [ "Shalini Ghosh", "Oriol Vinyals", "Brian Strope", "Scott Roy", "Tom Dean", "Larry Heck." ],
      "venue" : "arXiv.org, February.",
      "citeRegEx" : "Ghosh et al\\.,? 2016",
      "shortCiteRegEx" : "Ghosh et al\\.",
      "year" : 2016
    }, {
      "title" : "Improving neural networks by preventing coadaptation of feature detectors",
      "author" : [ "Geoffrey E Hinton", "Nitish Srivastava", "Alex Krizhevsky", "Ilya Sutskever", "Ruslan R Salakhutdinov." ],
      "venue" : "arXiv.org, July.",
      "citeRegEx" : "Hinton et al\\.,? 2012",
      "shortCiteRegEx" : "Hinton et al\\.",
      "year" : 2012
    }, {
      "title" : "An Improved Non-monotonic Transition System for Dependency Parsing",
      "author" : [ "Matthew Honnibal", "Mark Johnson." ],
      "venue" : "Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing, pages 1373–1378, Stroudsburg,",
      "citeRegEx" : "Honnibal and Johnson.,? 2015",
      "shortCiteRegEx" : "Honnibal and Johnson.",
      "year" : 2015
    }, {
      "title" : "Adam: A Method for Stochastic Optimization",
      "author" : [ "Diederik Kingma", "Jimmy Ba." ],
      "venue" : "arXiv.org, December.",
      "citeRegEx" : "Kingma and Ba.,? 2014",
      "shortCiteRegEx" : "Kingma and Ba.",
      "year" : 2014
    }, {
      "title" : "Skip-Thought Vectors",
      "author" : [ "Ryan Kiros", "Yukun Zhu", "Ruslan R Salakhutdinov", "Richard Zemel", "Raquel Urtasun", "Antonio Torralba", "Sanja Fidler." ],
      "venue" : "Advances in Neural . . . , pages 3294–3302.",
      "citeRegEx" : "Kiros et al\\.,? 2015",
      "shortCiteRegEx" : "Kiros et al\\.",
      "year" : 2015
    }, {
      "title" : "Distributed Representations of Sentences and Documents",
      "author" : [ "Quoc V Le", "Tomas Mikolov." ],
      "venue" : "ICML, pages 1188–1196.",
      "citeRegEx" : "Le and Mikolov.,? 2014",
      "shortCiteRegEx" : "Le and Mikolov.",
      "year" : 2014
    }, {
      "title" : "DependencyBased Word Embeddings",
      "author" : [ "Omer Levy", "Yoav Goldberg." ],
      "venue" : "Proceedings of the 52nd Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers), pages 302–308, Stroudsburg, PA, USA. Association for",
      "citeRegEx" : "Levy and Goldberg.,? 2014a",
      "shortCiteRegEx" : "Levy and Goldberg.",
      "year" : 2014
    }, {
      "title" : "Linguistic Regularities in Sparse and Explicit Word Representations",
      "author" : [ "Omer Levy", "Yoav Goldberg." ],
      "venue" : "CoNLL, pages 171–180.",
      "citeRegEx" : "Levy and Goldberg.,? 2014b",
      "shortCiteRegEx" : "Levy and Goldberg.",
      "year" : 2014
    }, {
      "title" : "Neural Word Embedding as Implicit Matrix Factorization",
      "author" : [ "Omer Levy", "Yoav Goldberg." ],
      "venue" : "Advances in Neural Information Processing . . . , pages 2177–2185.",
      "citeRegEx" : "Levy and Goldberg.,? 2014c",
      "shortCiteRegEx" : "Levy and Goldberg.",
      "year" : 2014
    }, {
      "title" : "Introduction to Information Retrieval",
      "author" : [ "Christopher D Manning", "Prabhakar Raghavan", "Hinrich Schutze." ],
      "venue" : "Cambridge University Press, Cambridge.",
      "citeRegEx" : "Manning et al\\.,? 2009",
      "shortCiteRegEx" : "Manning et al\\.",
      "year" : 2009
    }, {
      "title" : "Inferring Networks of Substitutable and Complementary Products",
      "author" : [ "Julian McAuley", "Rahul Pandey", "Jure Leskovec." ],
      "venue" : "ACM, New York, New York, USA, August.",
      "citeRegEx" : "McAuley et al\\.,? 2015",
      "shortCiteRegEx" : "McAuley et al\\.",
      "year" : 2015
    }, {
      "title" : "Distributed Representations of Words and Phrases and their Compositionality",
      "author" : [ "Tomas Mikolov", "Ilya Sutskever", "Kai Chen", "Gregory S Corrado", "Jeffrey Dean" ],
      "venue" : null,
      "citeRegEx" : "Mikolov et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Mikolov et al\\.",
      "year" : 2013
    }, {
      "title" : "Scikit-learn: Machine Learning in Python",
      "author" : [ "Brucher", "Matthieu Perrot", "Édouard Duchesnay." ],
      "venue" : "arXiv.org, January.",
      "citeRegEx" : "Brucher et al\\.,? 2012",
      "shortCiteRegEx" : "Brucher et al\\.",
      "year" : 2012
    }, {
      "title" : "Glove: Global Vectors for Word Representation",
      "author" : [ "Jeffrey Pennington", "Richard Socher", "Christopher Manning." ],
      "venue" : "Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing (EMNLP), pages 1532–1543, Strouds-",
      "citeRegEx" : "Pennington et al\\.,? 2014",
      "shortCiteRegEx" : "Pennington et al\\.",
      "year" : 2014
    }, {
      "title" : "Exploring the Space of Topic Coherence Measures",
      "author" : [ "Michael Röder", "Andreas Both", "Alexander Hinneburg." ],
      "venue" : "ACM, February.",
      "citeRegEx" : "Röder et al\\.,? 2015",
      "shortCiteRegEx" : "Röder et al\\.",
      "year" : 2015
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al.",
      "startOffset" : 111,
      "endOffset" : 130
    }, {
      "referenceID" : 3,
      "context" : ", 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al.",
      "startOffset" : 35,
      "endOffset" : 57
    }, {
      "referenceID" : 14,
      "context" : ", 2015), and infer networks of complementary products (McAuley et al., 2015).",
      "startOffset" : 54,
      "endOffset" : 76
    }, {
      "referenceID" : 0,
      "context" : "For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al., 2015). See Blei et al. (2010) for an overview of topic modelling in domains as diverse as computer vision, genetic markers, survey data, and social network data.",
      "startOffset" : 112,
      "endOffset" : 274
    }, {
      "referenceID" : 0,
      "context" : "For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al., 2015). See Blei et al. (2010) for an overview of topic modelling in domains as diverse as computer vision, genetic markers, survey data, and social network data. Dense vector approaches to building document representations also exist: Le and Mikolov (2014) propose paragraph vectors that are predictive of bags of words within paragraphs, Kiros et al.",
      "startOffset" : 112,
      "endOffset" : 501
    }, {
      "referenceID" : 0,
      "context" : "For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al., 2015). See Blei et al. (2010) for an overview of topic modelling in domains as diverse as computer vision, genetic markers, survey data, and social network data. Dense vector approaches to building document representations also exist: Le and Mikolov (2014) propose paragraph vectors that are predictive of bags of words within paragraphs, Kiros et al. (2015) build vectors that reconstruct the sentence sequences before and after a given sentence, and Ghosh et al.",
      "startOffset" : 112,
      "endOffset" : 603
    }, {
      "referenceID" : 0,
      "context" : "For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al., 2015). See Blei et al. (2010) for an overview of topic modelling in domains as diverse as computer vision, genetic markers, survey data, and social network data. Dense vector approaches to building document representations also exist: Le and Mikolov (2014) propose paragraph vectors that are predictive of bags of words within paragraphs, Kiros et al. (2015) build vectors that reconstruct the sentence sequences before and after a given sentence, and Ghosh et al. (2016) construct contextual LSTMs that predict proceeding sentence features.",
      "startOffset" : 112,
      "endOffset" : 716
    }, {
      "referenceID" : 0,
      "context" : "For example, using Latent Dirichlet Allocation (LDA) topic models can reveal cluster of words within documents (Blei et al., 2003), highlight temporal trends (Charlin et al., 2015), and infer networks of complementary products (McAuley et al., 2015). See Blei et al. (2010) for an overview of topic modelling in domains as diverse as computer vision, genetic markers, survey data, and social network data. Dense vector approaches to building document representations also exist: Le and Mikolov (2014) propose paragraph vectors that are predictive of bags of words within paragraphs, Kiros et al. (2015) build vectors that reconstruct the sentence sequences before and after a given sentence, and Ghosh et al. (2016) construct contextual LSTMs that predict proceeding sentence features. Probabilistic topic models tend to form documents as a sparse mixed-membership of topics while neural network models tend to model documents as dense vectors. By virtue of both their sparsity and low-dimensionality, representations from the former are simpler to inspect and more immediately yield high level intuitions about the underlying system (although not without hazards, see Chang et al. (2009)).",
      "startOffset" : 112,
      "endOffset" : 1189
    }, {
      "referenceID" : 13,
      "context" : "Once created, these representations are then useful for information retrieval (Manning et al., 2009) and parsing tasks (Levy and Goldberg, 2014a).",
      "startOffset" : 78,
      "endOffset" : 100
    }, {
      "referenceID" : 10,
      "context" : ", 2009) and parsing tasks (Levy and Goldberg, 2014a).",
      "startOffset" : 26,
      "endOffset" : 52
    }, {
      "referenceID" : 11,
      "context" : "For example, Mikolov et al. (2013) utilize Skipgram NegativeSampling (SGNS) to train word embeddings using word-context pairs formed from windows moving across a text corpus.",
      "startOffset" : 13,
      "endOffset" : 35
    }, {
      "referenceID" : 10,
      "context" : "In fact, Levy and Goldberg (2014c) demonstrate that this is implicitly factorizing a variant of the Pointwise Mutual Information (PMI) matrix that emphasizes predicting frequent co-occurrences over rare ones.",
      "startOffset" : 9,
      "endOffset" : 35
    }, {
      "referenceID" : 10,
      "context" : "In fact, Levy and Goldberg (2014c) demonstrate that this is implicitly factorizing a variant of the Pointwise Mutual Information (PMI) matrix that emphasizes predicting frequent co-occurrences over rare ones. Closely related to the PMI matrix, Pennington et al. (2014) factorize a large global word count co-occurrence matrix to yield more efficient and slightly more performant computed embeddings than SGNS.",
      "startOffset" : 9,
      "endOffset" : 269
    }, {
      "referenceID" : 15,
      "context" : "We are interested in modifying the Skipgram Negative-Sampling (SGNS) objective in (Mikolov et al., 2013) to utilize document-wide feature vectors while simultaneously learning continuous document weights loading onto topic vectors.",
      "startOffset" : 82,
      "endOffset" : 104
    }, {
      "referenceID" : 15,
      "context" : "1 Word Representation As in Mikolov et al. (2013), pairs of pivot and target words (j, i) are extracted when they co-",
      "startOffset" : 28,
      "endOffset" : 50
    }, {
      "referenceID" : 15,
      "context" : "Each word is represented with a fixedlength dense distributed-representation vector, but unlike Mikolov et al. (2013) the same word vectors are used in both the pivot and target representations.",
      "startOffset" : 96,
      "endOffset" : 118
    }, {
      "referenceID" : 15,
      "context" : "Each word is represented with a fixedlength dense distributed-representation vector, but unlike Mikolov et al. (2013) the same word vectors are used in both the pivot and target representations. The SGNS loss shown in (2) attempts to discriminate context-word pairs that appear in the corpus from those randomly sampled from a ‘negative’ pool of words. This loss is minimized when the observed words are completely separated from the marginal distribution. The distribution from which tokens are drawn is uβ , where u denotes the overall word frequency normalized by the total corpus size. Unless stated otherwise, the negative sampling power beta is set to 3/4 and the number of negative samples is fixed to n = 15 as in Mikolov et al. (2013). Note that a distribution of u0.",
      "startOffset" : 96,
      "endOffset" : 744
    }, {
      "referenceID" : 15,
      "context" : "Mikolov et al. (2013) provide the intuition that word vectors can be summed together to form a semantically meaningful combination of both words.",
      "startOffset" : 0,
      "endOffset" : 22
    }, {
      "referenceID" : 5,
      "context" : "In order to prevent co-adaptation, we also perform dropout on both the unnormalized document vector ~ dj and the pivot word vector ~ wj (Hinton et al., 2012).",
      "startOffset" : 136,
      "endOffset" : 157
    }, {
      "referenceID" : 7,
      "context" : "3 Preprocessing and Training The objective in (1) is trained in individual minibatches at a time while using the Adam optimizer (Kingma and Ba, 2014) for two hundred epochs across the dataset.",
      "startOffset" : 128,
      "endOffset" : 149
    }, {
      "referenceID" : 11,
      "context" : "Token-toword similarity is evaluated using the 3COSMUL measure (Levy and Goldberg, 2014b).",
      "startOffset" : 63,
      "endOffset" : 89
    }, {
      "referenceID" : 7,
      "context" : "3 Preprocessing and Training The objective in (1) is trained in individual minibatches at a time while using the Adam optimizer (Kingma and Ba, 2014) for two hundred epochs across the dataset. The Dirichlet likelihood term Ld is typically computed over all documents, so in modifying the objective to minibatches we adjust the loss of the term to be proportional to the minibatch size divided by the size of the total corpus. Our software is open source, available online, documented and unit tested1. Finally, the top ten most likely words in a given topic are submitted to the online Palmetto2 topic quality measuring tool and the coherence measure Cv is recorded. After evaluating multiple alternatives, Cv is the recommended coherence metric in Röder et al. (2015). This measure averages the Normalized Pointwise Mutual Information (NPMI) for every pair of words within a sliding window of size 110 on an external corpus and returns mean of the NPMI for the submitted set of words.",
      "startOffset" : 129,
      "endOffset" : 769
    }, {
      "referenceID" : 18,
      "context" : "The topic coherence has been demonstrated to correlate with human evaluations of topic models (Röder et al., 2015).",
      "startOffset" : 94,
      "endOffset" : 114
    }, {
      "referenceID" : 6,
      "context" : ", 2012) and tokens are identified using the SpaCy parser (Honnibal and Johnson, 2015).",
      "startOffset" : 57,
      "endOffset" : 85
    }, {
      "referenceID" : 6,
      "context" : ", 2012) and tokens are identified using the SpaCy parser (Honnibal and Johnson, 2015). Words are lemmatized to group multiple inflections into single tokens. Tokens that occur fewer than ten times in the corpus are removed, as are tokens that appear to be URLs, numbers or contain special symbols within their orthographic forms. After preprocessing, the dataset contains 1.8 million observations of 8,946 unique tokens in 11,313 documents. Word vectors are initialized to the pretrained values found in Mikolov et al. (2013) but otherwise updates are allowed to these vectors at training time.",
      "startOffset" : 58,
      "endOffset" : 526
    }, {
      "referenceID" : 6,
      "context" : "To take advantage of this rich corpus, we use the SpaCy to tokenize whole noun phrases and entities at once (Honnibal and Johnson, 2015).",
      "startOffset" : 108,
      "endOffset" : 136
    }, {
      "referenceID" : 0,
      "context" : "These topics demonstrate that the major themes of the corpus are reproduced and represented in learned topic vectors in a similar fashion as in LDA (Blei et al., 2003).",
      "startOffset" : 148,
      "endOffset" : 167
    }, {
      "referenceID" : 15,
      "context" : "Figure 5 demonstrates that token similarities are learned in a similar fashion as in SGNS (Mikolov et al., 2013) but specialized to the Hacker News corpus.",
      "startOffset" : 90,
      "endOffset" : 112
    }, {
      "referenceID" : 11,
      "context" : "The subtractions and additions of vectors are evaluated literally, but instead take advantage of the 3COSMUL objective (Levy and Goldberg, 2014b).",
      "startOffset" : 119,
      "endOffset" : 145
    }, {
      "referenceID" : 15,
      "context" : "3 Conclusion This work demonstrates a simple model, lda2vec, that extends SGNS (Mikolov et al., 2013) to build unsupervised document representations that yield coherent topics.",
      "startOffset" : 79,
      "endOffset" : 101
    }, {
      "referenceID" : 0,
      "context" : "Word, topic, and document vectors are jointly trained and embedded in a common representation space that preserves semantic regularities between the learned word vectors while still yielding sparse and interpretable documentto-topic proportions in the style of LDA (Blei et al., 2003).",
      "startOffset" : 265,
      "endOffset" : 284
    }, {
      "referenceID" : 18,
      "context" : "Topics formed in the Twenty Newsgroups corpus yield high mean topic coherences which have been shown to correlate with human evaluations of topics (Röder et al., 2015).",
      "startOffset" : 147,
      "endOffset" : 167
    } ],
    "year" : 2016,
    "abstractText" : "Distributed dense word vectors have been shown to be effective at capturing tokenlevel semantic and syntactic regularities in language, while topic models can form interpretable representations over documents. In this work, we describe lda2vec, a model that learns dense word vectors jointly with Dirichlet-distributed latent document-level mixtures of topic vectors. In contrast to continuous dense document representations, this formulation produces sparse, interpretable document mixtures through a non-negative simplex constraint. Our method is simple to incorporate into existing automatic differentiation frameworks and allows for unsupervised document representations geared for use by scientists while simultaneously learning word vectors and the linear relationships between them.",
    "creator" : "TeX"
  }
}