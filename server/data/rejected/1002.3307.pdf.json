{
  "name" : "1002.3307.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : null,
    "authors" : [ ],
    "emails" : [ "watay@ism.ac.jp", "fukumizu@ism.ac.jp" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n00 2.\n33 07\nv1 [\ncs .A\nI] 1\n7 Fe"
    }, {
      "heading" : "1 Introduction",
      "text" : "Pearl’s belief propagation [1] provides an efficient method for exact computation in the inference with probabilistic models associated to trees. As an extension to general graphs allowing cycles, Loopy Belief Propagation (LBP) algorithm [2] has been proposed, showing successful performance in various problems such as computer vision and error correcting codes.\nOne of the interesting theoretical aspects of LBP is its connection with the Bethe free energy [3]. It is known, for example, the fixed points of LBP correspond to the stationary points of the Bethe free energy. Nonetheless, many of the properties of LBP such as exactness, convergence and stability are still unclear, and further theoretical understanding is needed.\nThis paper theoretically analyzes LBP by establishing a formula asserting that the determinant of the Hessian of the Bethe free energy equals the reciprocal of the edge zeta function up to a positive factor. This formula derives a variety of results on the properties of LBP such as stability and uniqueness, since the zeta function has a direct link with the dynamics of LBP as we show.\nThe first application of the formula is the condition for the positive definiteness of the Hessian of the Bethe free energy. The Bethe free energy is not necessarily convex, which causes unfavorable behaviors of LBP such as oscillation and multiple fixed points. Thus, clarifying the region where the Hessian is positive definite is an importance problem. Unlike the previous approaches which consider the global structure of the Bethe free energy such as [4, 5], we focus the local structure. Namely, we provide a simple sufficient condition that determines the positive definite region: if all the correlation coefficients of the pseudomarginals are smaller than a value given by a characteristic of the graph, the Hessian is positive definite. Additionally, we show that the Hessian always has a negative eigenvalue around the boundary of the domain if the graph has at least two cycles.\nSecond, we clarify a relation between the local stability of a LBP fixed point and the local structure of the Bethe free energy. Such a relation is not necessarily obvious, since LBP is not the gradient descent of the Bethe free energy. In this line of studies, Heskes [6] shows that a locally stable fixed point of LBP is a local minimum of the Bethe free energy. It is thus interesting to ask which local\nminima of the Bethe free energy are stable or unstable fixed points of LBP. We answer this question by elucidating the conditions of the local stability of LBP and the positive definiteness of the Bethe free energy in terms of the eigenvalues of a matrix, which appears in the graph zeta function.\nFinally, we discuss the uniqueness of LBP fixed point by developing a differential topological result on the Bethe free energy. The result shows that the determinant of the Hessian at the fixed points, which appears in the formula of zeta function, must satisfy a strong constraint. As a consequence, in addition to the known result on the one-cycle case, we show that the LBP fixed point is unique for any unattractive connected graph with two cycles without restricting the strength of interactions."
    }, {
      "heading" : "2 Loopy belief propagation algorithm and the Bethe free energy",
      "text" : "Throughout this paper, G = (V,E) is a connected undirected graph with V the vertices and E the undirected edges. The cardinality of V and E are denoted by N and M respectively.\nIn this article we focus on binary variables, i.e., xi ∈ {±1}. Suppose that the probability distribution over the set of variables x = (xi)i∈V is given by the following factorization form with respect to G:\np(x) = 1\nZ\n∏\nij∈E\nψij(xi, xj) ∏\ni∈V\nψi(xi), (1)\nwhere Z is a normalization constant and ψij and ψi are positive functions given by ψij(xi, xj) = exp(Jijxixj) and ψi(xi) = exp(hixi) without loss of generality.\nIn various applications, the computation of marginal distributions pi(xi) := ∑\nx\\{xi} p(x) and\npij(xi, xj) := ∑\nx\\{xixj} p(x) is required though the exact computation is intractable for large\ngraphs. If the graph is a tree, they are efficiently computed by Pearl’s belief propagation algorithm [1]. Even if the graph has cycles, it is empirically known that the direct application of this algorithm, called Loopy Belief Propagation (LBP), often gives good approximation.\nLBP is a message passing algorithm. For each directed edge, a message vector µi→j(xj) is assigned and initialized arbitrarily. The update rule of messages is given by\nµnewi→j(xj) ∝ ∑\nxi\nψji(xj , xi)ψi(xi) ∏\nk∈Ni\\j\nµk→i(xi), (2)\nwhere Ni is the neighborhood of i ∈ V . The order of edges in the update is arbitrary. In this paper we consider parallel update, that is, all edges are updated simultaneously. If the messages converge to a fixed point {µ∞i→j}, the approximations of pi(xi) and pij(xi, xj) are calculated by the beliefs,\nbi(xi) ∝ ψi(xi) ∏\nk∈Ni\nµ ∞ k→i(xi), bij(xi, xj) ∝ ψij(xi, xj)ψi(xi)ψj(xj)\n∏\nk∈Ni\\j\nµ ∞ k→i(xi)\n∏\nk∈Nj\\i\nµ ∞ k→j(xj),\n(3) with normalization ∑\nxi bi(xi) = 1 and\n∑\nxi,xj bij(xi, xj) = 1. From (2) and (3), the constraints\nbij(xi, xj) > 0 and ∑\nxj bij(xi, xj) = bi(xi) are automatically satisfied.\nWe introduce the Bethe free energy as a tractable approximation of the Gibbs free energy. The exact distribution (1) is characterized by a variational problem p(x) = argminp̂ FGibbs(p̂), where the minimum is taken over all probability distributions on (xi)i∈V and FGibbs(p̂) is the Gibbs free energy defined by FGibbs(p̂) = KL(p̂||p)− logZ . Here KL(p̂||p) = ∫\np̂ log(p̂/p) is the KullbackLeibler divergence from p̂ to p. Note that FGibbs(p̂) is a convex function of p̂.\nIn the Bethe approximation, we confine the above minimization to the distribution of the form b(x) ∝ ∏\nij∈E bij(xi, xj) ∏ i∈V bi(xi) 1−di , where di := |Ni| is the degree and the constraints\nbij(xi, xj) > 0, ∑\nxi,xj bij(xi, xj) = 1 and\n∑\nxj bij(xi, xj) = bi(xi) are satisfied. A set\n{bi(xi), bij(xi, xj)} satisfying these constraints is called pseudomarginals. For computational tractability, we modify the Gibbs free energy to the objective function called Bethe free energy:\nF (b) :=− ∑\nij∈E\n∑\nxixj\nbij(xi, xj) logψij(xi, xj)− ∑\ni∈V\n∑\nxi\nbi(xi) logψi(xi)\n+ ∑\nij∈E\n∑\nxixj\nbij(xi, xj) log bij(xi, xj) + ∑\ni∈V\n(1− di) ∑\nxi\nbi(xi) log bi(xi). (4)\nThe domain of the objective function F is the set of pseudomarginals. The function F does not necessarily have a unique minimum. The outcome of this modified variational problem is the same as that of LBP [3]. To put it more precisely, There is a one-to-one correspondence between the set of stationary points of the Bethe free energy and the set of fixed points of LBP.\nIt is more convenient if we work with minimal parameters, mean mi = Ebi [xi] and correlation χij = Ebij [xixj ]. Then we have an effective parametrization of pseudomarginals:\nbij(xi, xj) = 1\n4 (1 +mixi +mjxj + χijxixj), bi(xi) =\n1 2 (1 +mi). (5)\nThe Bethe free energy (4) is rewritten as\nF ({mi, χij}) = − ∑\nij∈E\nJijχij − ∑\ni∈V\nhimi\n+ ∑\nij∈E\n∑\nxixj\nη (1+mixi+mjxj+ χijxixj\n4\n)\n+ ∑\ni∈V\n(1− di) ∑\nxi\nη (1 +mixi\n2\n)\n, (6)\nwhere η(x) := x log x. The domain of F is written as\nL(G) := { {mi, χij} ∈ R N+M |1+mixi+mjxj +χijxixj > 0 for all ij ∈ E and xi, xj = ±1 } .\nThe Hessian of F , which consists of the second derivatives with respect to {mi, χij}, is a square matrix of size N +M and denoted by ∇2F . This is considered to be a matrix-valued function on L(G). Note that, from (6), ∇2F does not depend on Jij and hi."
    }, {
      "heading" : "3 Zeta function and Hessian of Bethe free energy",
      "text" : ""
    }, {
      "heading" : "3.1 Zeta function and Ihara’s formula",
      "text" : "For each undirected edge of G, we make a pair of oppositely directed edges, which form a set of directed edges ~E. Thus | ~E| = 2M . For each directed edge e ∈ ~E, o(e) ∈ V is the origin of e and t(e) ∈ V is the terminus of e. For e ∈ ~E, the inverse edge is denoted by ē, and the corresponding undirected edge by [e] = [ē] ∈ E.\nA closed geodesic in G is a sequence (e1, . . . , ek) of directed edges such that t(ei) = o(ei+1) and ei 6= ēi+1 for i ∈ Z/kZ. Two closed geodesics are said to be equivalent if one is obtained by cyclic permutation of the other. An equivalent class of closed geodesics is called a prime cycle if it is not a repeated concatenation of a shorter closed geodesic. Let P be the set of prime cycles of G. For given weights u = (ue)e∈ ~E , the edge zeta function [7, 8] is defined by\nζG(u) := ∏\np∈P\n(1− g(p))−1, g(p) := ue1 · · ·uek for p = (e1, . . . , ek),\nwhere ue ∈ C is assumed to be sufficiently small for convergence. This is an analogue of the Riemann zeta function which is represented by the product over all the prime numbers.\nExample 1. If G is a tree, which has no prime cycles, ζG(u) = 1. For 1-cycle graph CN of length N , the prime cycles are (e1, e2, . . . , eN ) and (ēN , ēN−1, . . . , ē1), and thus ζCN (u) = (1 − ∏N\nl=1 uel) −1(1− ∏N l=1 uēl) −1. Except for these two types of graphs, the number of prime cycles is infinite.\nIt is known that the edge zeta function has the following simple determinant formula, which gives analytical continuation to the whole C2M . Let C( ~E) be the set of functions on the directed edges. We define a matrix on C( ~E), which is determined by the graph G, by\nMe,e′ :=\n{\n1 if e 6= ē′ and o(e) = t(e′), 0 otherwise.\n(7)\nTheorem 1 ([8], Theorem 3). ζG(u) = det(I − UM)\n−1, (8) where U is a diagonal matrix defined by Ue,e′ := ueδe,e′ .\nWe need to show another determinant formula of the edge zeta function, which is used in the proof of Theorem 3. We leave the proof of Theorem 2 to the supplementary material. Theorem 2 (Multivariable version of Ihara’s formula). Let C(V ) be the set of functions on V . We define two linear operators on C(V ) by\n(D̂f)(i) := ( ∑\ne∈~E t(e)=i\nueuē 1− ueuē ) f(i), (Âf)(i) := ∑\ne∈~E t(e)=i\nue 1− ueuē f(o(e)), where f ∈ C(V ).\n(9) Then we have\n(\nζG(u) −1 =\n)\ndet(I − UM) = det(I + D̂ − Â) ∏\n[e]∈E\n(1− ueuē). (10)\nIf we set ue = u for all e ∈ ~E , the edge zeta function is called the Ihara zeta function [9] and denoted by ζG(u). In this single variable case, Theorem 2 is reduced to Ihara’s formula [10]:\nζG(u) −1 = det(I − uM) = (1− u2)M det(I +\nu2\n1− u2 D −\nu\n1− u2 A), (11)\nwhere D is the degree matrix and A is the adjacency matrix defined by\n(Df)(i) := dif(i), (Af)(i) := ∑\ne∈ ~E,t(e)=i\nf(o(e)), f ∈ C(V )."
    }, {
      "heading" : "3.2 Main formula",
      "text" : "Theorem 3 (Main Formula). The following equality holds at any point of L(G): (\nζG(u) −1=\n)\ndet(I − UM) = det(∇2F ) ∏\nij∈E\n∏\nxi,xj=±1\nbij(xi, xj) ∏\ni∈V\n∏\nxi=±1\nbi(xi) 1−di 22N+4M ,\n(12) where bij and bi are given by (5) and\nui→j := χij −mimj\n1−m2j . (13)\nProof. (The detail of the computation is given in the supplementary material.) From (6), it is easy to see that the (E,E)-block of the Hessian is a diagonal matrix given by\n∂2F\n∂χij∂χkl = δij,kl\n1\n4\n( 1\n1+mi+mj+χij +\n1\n1−mi+mj−χij +\n1\n1+mi−mj−χij +\n1\n1−mi−mj+χij\n)\n.\nUsing this diagonal block, we erase (V,E)-block and (E,V)-block of the Hessian. In other words, we choose a square matrix X such that detX = 1 and\nXT (∇2F )X =\n[\nY 0 0 (\n∂2F ∂χij∂χkl\n)\n]\n.\nAfter the computation given in the supplementary material, we see that\n(Y )i,j =\n\n\n\n1 1−m2i + ∑ k∈Ni\n(χik−mimk) 2\n(1−m2i )(1−m 2 i−m 2 k +2mimkχik−χ2ik)\nif i = j,\n−Ai,j χij−mimj\n1−m2i−m 2 j+2mimjχij−χ 2 ij\notherwise. (14)\nFrom uj→i = χij−mimj\n1−m2i , it is easy to check that IN + D̂ − Â = YW , where Â and D̂ is defined in\n(9) and W is a diagonal matrix defined by Wi,j := δi,j(1−m2i ). Therefore,\ndet(I − UM) = det(Y ) ∏\ni∈V\n(1−m2i ) ∏\n[e]∈E\n(1− ueuē) = R.H.S. of (12)\nFor the left equality, Theorem 2 is used.\nTheorem 3 shows that the determinant of the Hessian of the Bethe free energy is essentially equal to det(I−UM), the reciprocal of the edge zeta function. Since the matrix UM has a direct connection with LBP as seen in section 5, the above formula derives many consequences shown in the rest of the paper."
    }, {
      "heading" : "4 Application to positive definiteness conditions",
      "text" : "The convexity of the Bethe free energy is an important issue, as it guarantees uniqueness of the fixed point. Pakzad et al [11] and Heskes [5] derive sufficient conditions of convexity and show that the Bethe free energy is convex for trees and graphs with one cycle. In this section, instead of such global structure, we shall focus the local structure of the Bethe free energy as an application of the main formula.\nFor given square matrix X , Spec(X) ⊂ C denotes the set of eigenvalues (spectra), and ρ(X) the spectral radius of a matrix X , i.e., the maximum of the modulus of the eigenvalues. Theorem 4. Let M be the matrix given by (7). For given {mi, χij} ∈ L(G), U is defined by (13). Then, Spec(UM) ⊂ C \\ R≥1 =⇒ ∇2F is a positive definite matrix at {mi, χij}.\nProof. We define mi(t) := mi and χij(t) := tχij + (1 − t)mimj . Then {mi(t), χij(t)} ∈ L(G) and {mi(1), χij(1)} = {mi, χij}. For t ∈ [0, 1], we define U(t) and ∇2F (t) in the same way by {mi(t), χij(t)}. We see that U(t) = tU . Since Spec(UM) ⊂ C\\R≥1, we have det(I−tUM) 6= 0 ∀t ∈ [0, 1]. From Theorem 3, det(∇2F (t)) 6= 0 holds on this interval. Using (14) and χij(0) = mi(0)mj(0), we can check that ∇2F (0) is positive definite. Since the eigenvalues of ∇2F (t) are real and continuous with respect t, the eigenvalues of ∇2F (1) must be positive reals.\nWe define the symmetrization of ui→j and uj→i by\nβi→j = βj→i := χij −mimj\n{(1−m2i )(1−m 2 j)}\n1/2 =\nCovbij [xi, xj ]\n{Varbi [xi]Varbj [xj ]} 1/2\n. (15)\nThus, ui→juj→i = βi→jβj→i. Since βi→j = βj→i, we sometimes abbreviate βi→j as βij . From the final expression, we see that |βij | < 1. Define diagonal matrices Z and B by (Z)e,e′ := δe,e′(1−m 2 t(e)) 1/2 and (B)e,e′ := δe,e′βe respectively. Then we have ZUMZ−1 = BM, because\n(ZUMZ−1)e,e′ = (1−m 2 t(e)) 1/2ue(M)e,e′(1 −m 2 o(e)) −1/2 = βe(M)e,e′ .\nTherefore Spec(UM) = Spec(BM).\nThe following corollary gives a more explicit condition of the region where the Hessian is positive definite in terms of the correlation coefficients of the pseudomarginals. Corollary 1. Let α be the Perron Frobenius eigenvalue of M and define Lα−1(G) := {{mi, χij} ∈ L(G)||βe| < α −1 for all e ∈ ~E}. Then, the Hessian ∇2F is positive definite on Lα−1(G).\nProof. Since |βe| < α−1, we have ρ(BM) < ρ(α−1M) = 1 ([12] Theorem 8.1.18). Therefore Spec(BM) ∩ R≥1 = φ.\nAs is seen from (11), α−1 is the distance from the origin to the nearest pole of Ihara’s zeta ζG(u). From example 1, we see that ζG(u) = 1 for a tree G and ζCN (u) = (1− u\nN )−2 for a 1-cycle graph CN . Therefore α−1 is ∞ and 1 respectively. In these cases, Lα−1(G) = L(G) and F is a strictly convex function on L(G), because |βe| < 1 always holds. This reproduces the results shown in [11]. In general, using Theorem 8.1.22 of [12], we have mini∈V di − 1 ≤ α ≤ maxi∈V di − 1.\nTheorem 3 is also useful to show non-convexity. Corollary 2. Let {mi(t) := 0, χij(t) := t} ∈ L(G) for t < 1. Then we have\nlim t→1\ndet(∇2F (t))(1 − t)M+N−1 = −2−M−N+1(M −N)κ(G), (16)\nwhere κ(G) is the number of spanning trees in G. In particular, F is never convex on L(G) for any connected graph with at least two linearly independent cycles, i.e. M −N ≥ 1.\nProof. The equation (16) is obtained by Hashimoto’s theorem [13], which gives the u → 1 limit of the Ihara zeta function. (See supplementary material for the detail.) If M − N ≥ 1, the right hand side of (16) is negative. As approaches to {mi = 0, χij = 1} ∈ L(G), the determinant of the Hessian diverges to −∞. Therefore the Hessian is not positive definite near the point.\nSummarizing the results in this section, we conclude that F is convex on L(G) if and only if G is a tree or a graph with one cycle. To the best of our knowledge, this is the first proof of this fact."
    }, {
      "heading" : "5 Application to stability analysis",
      "text" : "In this section we discuss the local stability of LBP and the local structure of the Bethe free energy around a LBP fixed point. Heskes [6] shows that a locally stable fixed point of sufficiently damped LBP is a local minima of the Bethe free energy. The converse is not necessarily true in general, and we will elucidate the gap between these two properties.\nFirst, we regard the LBP update as a dynamical system. Since the model is binary, each message µi→j(xj) is parametrized by one parameter, say ηi→j . The state of LBP algorithm is expressed by η = (ηe)e∈ ~E ∈ C( ~E), and the update rule (2) is identified with a transform T on C( ~E), ηnew = T (η). Then, the set of fixed points of LBP is {η∞ ∈ C( ~E)|T (η∞) = η∞}.\nA fixed point η∞ is called locally stable if LBP starting with a point sufficiently close to η∞ converges to η∞. The local stability is determined by the linearizion T ′ around the fixed point. As is discussed in [14], η∞ is locally stable if and only if Spec(T ′(η∞)) ⊂ {λ ∈ C||λ| < 1}.\nTo suppress oscillatory behaviors of LBP, damping of update Tǫ := (1 − ǫ)T + ǫI is sometimes useful, where 0 ≤ ǫ < 1 is a damping strength and I is the identity. A fixed point is locally stable with some damping if and only if Spec(T ′(η∞)) ⊂ {λ ∈ C|Reλ < 1}.\nThere are many representations of the linearization (derivative) of LBP update (see [14, 15]), we choose a good coordinate following Furtlehner et al [16]. In section 4 of [16], they transform messages as µi→j → µi→j/µ∞i→j and functions as ψij → bij/(bibj) and ψi → bi, where µ ∞ i→j is the message of the fixed point. This changes only the representations of messages and functions, and does not affect LBP essentially. This transformation causes T ′(η∞) → P T ′(η∞)P−1 with an invertible matrix P . Using this transformation, we see that the following fact holds. (See supplementary material for the detail.)\nTheorem 5 ([16], Proposition 4.5). Let ui→j be given by (3), (5) and (13) at a LBP fixed point η∞. The derivative T ′(η∞) is similar to UM, i.e. UM = P T ′(η∞)P−1 with an invertible matrix P .\nSince det(I − T ′ (η∞)) = det(I − UM), the formula in Theorem 3 implies a direct link between the linearization T ′\n(η∞) and the local structure of the Bethe free energy. From Theorem 4, we have that a fixed point of LBP is a local minimum of the Bethe free energy if Spec(T ′(η∞)) ⊂ C\\R≥1.\nIt is now clear that the condition for positive definiteness, local stability of damped LBP and local stability of undamped LBP are given in terms of the set of eigenvalues, C \\R≥1, {λ ∈ C|Reλ < 1} and {λ ∈ C||λ| < 1} respectively. A locally stable fixed point of sufficiently damped LBP is a local minimum of the Bethe free energy, because {λ ∈ C|Reλ < 1} is included in C \\ R≥1. This reproduces Heskes’s result [6]. Moreover, we see the gap between the locally stable fixed points with some damping and the local minima of the Bethe free energy: if Spec(T ′(η∞)) is included in C \\ R≥1 but not in {λ ∈ C|Reλ < 1}, the fixed point is a local minimum of the Bethe free energy though it is not a locally stable fixed point of LBP with any damping.\nIt is interesting to ask under which condition a local minimum of the Bethe free energy is a stable fixed point of (damped) LBP. While we do not know a complete answer, for an attractive model, which is defined by Jij ≥ 0, the following theorem implies that if a stable fixed point becomes unstable by changing Jij and hi, the corresponding local minimum also disappears.\nTheorem 6. Let us consider continuously parametrized attractive models {ψij(t), ψi(t)}, e.g. t is a temperature: ψij(t) = exp(t−1Jijxixj) and ψi(t) = exp(t−1hixi). For given t, run LBP algorithm and find a (stable) fixed point. If we continuously change t and see the LBP fixed point becomes unstable across t = t0, then the corresponding local minimum of the Bethe free energy becomes a saddle point across t = t0.\nProof. From (3), we see bij(xi, xj) ∝ exp(Jijxixj + θixi + θjxj) for some θi and θj . From Jij ≥ 0, we have Covbij [xi, xj ] = χij −mimj ≥ 0, and thus ui→j ≥ 0. When the LBP fixed point becomes unstable, the Perron Frobenius eigenvalue of UM goes over 1, which means det(I−UM) crosses 0. From Theorem 3 we see that det(∇2F ) becomes positive to negative at t = t0.\nTheorem 6 extends Theorem 2 of [14], which discusses only the case of vanishing local fields hi = 0 and the trivial fixed point (i.e. mi = 0)."
    }, {
      "heading" : "6 Application to uniqueness of LBP fixed point",
      "text" : "The uniqueness of LBP fixed point is a concern of many studies, because the property guarantees that LBP finds the global minimum of the Bethe free energy if it converges. The major approaches to the uniqueness is to consider equivalent minimax problem [5], contraction property of LBP dynamics [17, 18], and to use the theory of Gibbs measure [19]. We will propose a different, differential topological approach to this problem.\nIn our approach, in combination with Theorem 3, the following theorem is the basic apparatus.\nTheorem 7. If det∇2F (q) 6= 0 for all q ∈ (∇F )−1(0) then\n∑\nq:∇F (q)=0\nsgn ( det∇2F (q) ) = 1, where sgn(x) :=\n{\n1 if x > 0, −1 if x < 0.\nWe call each summand, which is +1 or −1, the index of F at q.\nNote that the set (∇F )−1(0), which is the stationary points of the Bethe free energy, coincides with the fixed points of LBP. The above theorem asserts that the sum of indexes of all the fixed points must be one. As a consequence, the number of the fixed points of LBP is always odd. Note also that the index is a local quantity, while the assertion expresses the global structure of the function F .\nFor the proof of Theorem 7, we prepare two lemmas. The proof of Lemma 1 is shown in the supplementary material. Lemma 2 is a standard result in differential topology, and we refer [20] Theorem 13.1.2 and comments in p.104 for the proof.\nLemma 1. If a sequence {qn} ⊂ L(G) converges to a point q∗ ∈ ∂L(G), then ‖∇F (qn)‖ → ∞, where ∂L(G) is the boundary of L(G) ⊂ RN+M .\nLemma 2. Let M1 and M2 be compact, connected and orientable manifolds with boundaries. Assume that the dimensions of M1 and M2 are the same. Let f : M1 → M2 be a smooth map satisfying f(∂M1) ⊂ ∂M2. For a regular value of p ∈ M2, i.e. det(∇f(q)) 6= 0 for all q ∈ f−1(p), we define the degree of the map f by deg f := ∑\nq∈f−1(p) sgn(det∇f(q)). Then deg f does not depend on the choice of a regular value p ∈ M2.\nSketch of proof. Define a map Φ : L(G) → RN+M by Φ := ∇F + ( h\nJ\n)\n. Note that Φ does not depend on h and J as seen from (6). Then it is enough to prove\n∑\nq∈Φ−1((hJ))\nsgn(det∇Φ(q)) = ∑\nq∈Φ−1(0)\nsgn(det∇Φ(q)), (17)\nbecause Φ−1(0) has a unique element {mi = 0, χij = 0}, at which ∇2F is positive definite, and the right hand side of (45) is equal to one. Define a sequence of manifolds {Cn} by Cn := {q ∈ L(G)| ∑\nij∈E\n∑\nxi,xj − log bij ≤ n}, which increasingly converges to L(G). Take K > 0 and ǫ > 0\nto satisfy K − ǫ > ‖ ( h J ) ‖. From Lemma 1, for sufficiently large n0, we have Φ−1(0),Φ−1 ( h J )\n⊂ Cn0 and Φ(∂Cn0) ∩ B0(K) = φ, where B0(K) is the closed ball of radius K at the origin. Let Πǫ : R\nN+M → B0(K) be a smooth map that is the identity on B0(K−ǫ), monotonically increasing on ‖x‖, and Πǫ(x) = K‖x‖x for ‖x‖ ≥ K . We obtain a map Φ̃ := Πǫ ◦Φ : Cn0 → B0(K) such that\nΦ̃(∂Cn0) ⊂ ∂B0(K). Applying Lemma 2 yields (45).\nIf we can guarantee that the index of every fixed point is +1 in advance of running LBP, we conclude that fixed point of LBP is unique. We have the following a priori information for β.\nLemma 3. Let βij be given by (15) at any fixed point of LBP. Then |βij | ≤ tanh(|Jij |) and sgn(βij) = sgn(Jij) hold.\nProof. From (3), we see that bij(xi, xj) ∝ exp(Jijxixj + θixi + θjxj) for some θi and θj . With (15) and straightforward computation, we obtain βij = sinh(2Jij)(cosh(2θi) + cosh(2Jij)) −1/2(cosh(2θj)+cosh(2Jij)) −1/2. The bound is attained when θi = 0 and θj = 0.\nFrom Theorem 7 and Lemma 3, we can immediately obtain the uniqueness condition in [18], though the stronger contractive property is proved under the same condition in [18].\nCorollary 3 ([18]). If ρ(JM) < 1, then the fixed point of LBP is unique, where J is a diagonal matrix defined by Je,e′ = tanh(|Je|)δe,e′ .\nProof. Since |βij | ≤ tanh(|Jij |), we have ρ(BM) ≤ ρ(JM) < 1. ([12] Theorem 8.1.18.) Then det(I −BM) = det(I −UM) > 0 implies that the index of any LBP fixed point must be +1.\nIn the proof of the above corollary, we only used the bound of modulus. In the following case of Corollary 4, we can utilize the information of signs. To state the corollary, we need a terminology. The interactions {Jij , hi} and {J ′ij , h ′ i} are said to be equivalent if there exists (si) ∈ {±1}\nV such that J ′ij = Jijsisj and h ′ i = hisi. Since an equivalent model is obtained by gauge transformation xi → xisi, the uniqueness property of LBP for equivalent models is unchanged.\nCorollary 4. If the number of linearly independent cycle of G is two (i.e. M −N +1 = 2), and the interaction is not equivalent to attractive model, then the LBP fixed point is unique.\nThe proof is shown in the supplementary material. We give an example to illustrate the outline.\nExample 2. Let V := {1, 2, 3, 4} and E := {12, 13, 14, 23, 34}. The interactions are given by arbitrary {hi} and {−J12, J13, J14, J23, J34} with Jij ≥ 0. See figure 1. It is enough to check that det(I − BM) > 0 for arbitrary 0 ≤ β13, β23, β14, β34 < 1 and −1 < β12 ≤ 0. Since the prime cycles ofG bijectively correspond to those of Ĝ (in figure 2), we have det(I−BM) = det(I−B̂M̂), where β̂e1 = β12β23, β̂e2 = β13, and β̂e3 = β34. We see that det(I − B̂M̂) = (1 − β̂e1 β̂e2 − β̂e1 β̂e3 − β̂e2 β̂e3 − 2β̂e1 β̂e2 β̂e3)(1− β̂e1 β̂e2 − β̂e1 β̂e3 − β̂e2 β̂e3 +2β̂e1 β̂e2 β̂e3) > 0. In other cases, we can reduce to the graph Ĝ or the graphs in figure 3 similarly (see the supplementary material).\nFor attractive models, the fixed point of the LBP is not necessarily unique.\nFor graphs with multiple cycles, all the existing results on uniqueness make assumptions that upperbound |Jij | essentially. In contrast, Corollary 4 applies to arbitrary strength of interactions if the graph has two cycles and the interactions are not attractive. It is noteworthy that, from Corollary 2, the Bethe free energy is non-convex in the situation of Corollary 4, while the fixed point is unique."
    }, {
      "heading" : "7 Concluding remarks",
      "text" : "For binary pairwise models, we show the connection between the edge zeta function and the Bethe free energy in Theorem 3, in the proof of which the multi-variable version of Ihara’s formula (Theorem 2) is essential. After the initial submission of this paper, we found that Theorem 3 is extended to a more general class of models including multinomial models and Gaussian models represented by arbitrary factor graphs. We will discuss the extended formula and its applications in a future paper.\nSome recent researches on LBP have suggested the importance of zeta function. In the context of the LDPC code, which is an important application of LBP, Koetter et al [21, 22] show the connection between pseudo-codewords and the edge zeta function. On the LBP for the Gaussian graphical model, Johnson et al [23] give zeta-like product formula of the partition function. While these are not directly related to our work, pursuing covered connections is an interesting future research topic."
    }, {
      "heading" : "Acknowledgements",
      "text" : "This work was supported in part by Grant-in-Aid for JSPS Fellows 20-993 and Grant-in-Aid for Scientific Research (C) 19500249."
    }, {
      "heading" : "Supplementary Material for",
      "text" : "“Graph Zeta Function in the Bethe Free Energy and"
    }, {
      "heading" : "Loopy Belief Propagation”",
      "text" : ""
    }, {
      "heading" : "Yusuke Watanabe and Kenji Fukumizu, NIPS 2009",
      "text" : ""
    }, {
      "heading" : "A Proof of Theorem 2",
      "text" : "Proof. First, we define three linear operators O : C(V ) → C( ~E), T ∗ : C( ~E) → C(V ), and ι : C( ~E) → C( ~E) as follows:\n(Of)(e) := f(o(e)), (T ∗g)(i) := ∑\ne∈~E,t(e)=i\ng(e), (ιg)(e) := g(ē) where f ∈ C(V ) and g ∈ C( ~E).\nWe see that M = OT ∗ − ι, because\n( (OT ∗ − ι)g ) (e) = ∑\ne′∈ ~E,t(e′)=o(e)\ng(e′) − g(ē) = (Mg)(e) for g ∈ C( ~E).\nThen we have\ndet(I − UM) = det ( I − UOT ∗(I + Uι)−1 ) det(I + Uι)\n= det ( I − T ∗(I + Uι)−1UO ) det(I + Uι).\nIn the second equality, we used det(In − AB) = det(Im − BA) for n × m and m × n matrices A and B ([24], Lemma 8.2.4). The linear operator ι is a block diagonal matrix with standard basis. The (e, ē) block of I + Uι is\n[\n1 ue uē 1\n]\n.\nTherefore, we have det(I + Uι) = ∏\n[e]∈E(1− ueuē).\nFinally, we check that T ∗(I + Uι)−1UO = Â − D̂. The matrix (I + Uι)−1 is a block diagonal matrix with (e, ē) block\n1\n1− ueuē\n[\n1 −ue −uē 1\n]\n. (18)\nFor f ∈ C(V ), we have (\nT ∗(I + Uι)−1UOf ) (i) = ∑\ne∈ ~E,t(e)=i\n( (I + Uι)−1UOf ) (e)\n= ∑\ne∈ ~E,t(e)=i\n1\n1− ueuē\n( (UOf)(e) − ue(UOf)(ē) )\n= ∑\ne∈ ~E,t(e)=i\n1\n1− ueuē\n( uef(o(e))− ueuēf(o(ē)) )\n= (Âf)(i)− (D̂f)(i)."
    }, {
      "heading" : "B Proof of Theorem 3",
      "text" : "B.1 Explicit formula of derivatives of the Bethe free energy\nIn the proof of Theorem 3, the graph G = (V,E) is assumed to be a simple graph, i.e., there is no multiple edges and loop-edge\nFor the proof, we need explicit expressions of the second derivatives of the Bethe free energy. We list them below.\nThe first derivatives of the Bethe Free Energy are ∂F\n∂mi = −hi + (1− di)\n1\n2\n∑\nxi=±1\nxi log bi(xi) + 1\n4\n∑\nk∈Ni\n∑\nxi,xk=±1\nxi log bik(xi, xk), (19)\n∂F\n∂χij = −Jij +\n1\n4\n∑\nxi,xj=±1\nxixj log bij(xi, xj). (20)\nThe second derivatives of the Bethe Free Energy are\n∂2F\n∂mi∂mj =\n\n \n \n(1 − di) 1 1−m2i + 14\n∑\nk∈Ni\n∑\nxi,xk 1 1+mixi+mkxk+χikxixk if i = j,\n1 4\n∑\nxi,xj xixj 1+mixi+mjxj+χijxixj if i and j are adjacent (i 6= j),\n0 otherwise,\n(21)\n∂2F\n∂mk∂χij =\n\n \n \n1 4\n∑\nxi,xj xj 1+mixi+mjxj+χijxixj\nif k = i, 1 4 ∑ xi,xj xi 1+mixi+mjxj+χijxixj if k = j, 0 otherwise,\n(22)\n∂2F\n∂χij∂χkl =\n{\n1 4\n∑\nxixj 1 1+mixi+mjxj+χijxixj if ij = kl,\n0 otherwise. (23)\nWe use notations\nrij := 1\n4\n∑\nxi,xj\n1\n1 +mixi +mjxj + χijxixj , (24)\nsij := 1\n4\n∑\nxi,xj\nxj 1 +mixi +mjxj + χijxixj , (25)\ntij := 1\n4\n∑\nxi,xj\nxixj 1 +mixi +mjxj + χijxixj . (26)\nNote that rij = rji and tij = tji, but sij 6= sji in general."
    }, {
      "heading" : "B.2 Detailed proof of Theorem 3",
      "text" : "Proof. First, note that the Hessian of the Bethe free energy is a square matrix of size N +M :\n∇2F ({mi, χij}) :=\n\n\n(\n∂2F ∂mi∂mj\n) (\n∂2F ∂mi∂χst\n)\n(\n∂2F ∂χuv∂mj\n) (\n∂2F ∂χuv∂χst\n)\n\n .\nRecall that N is the number of vertices and M is the number of undirected edges.\nStep1: Computation of Y From (23), the (E,E)-block of the Hessian is a diagonal matrix given by\n∂2F\n∂χij∂χkl = δij,klrij .\nUsing this diagonal block, we erase (V,E)-block and (E,V)-block of the Hessian. Thus, we obtain a square matrix X such that detX = 1 and\nXT (∇2F )X =\n[\nY 0 0 (\n∂2F ∂χij∂χkl\n)\n]\n.\nApplying an identity\n\n \n1 0 −sij rij 0 1 −sji rij 0 0 1\n\n \n\n wi tij sij tij wj sji sij sji rij\n\n\n\n\n1 0 0 0 1 0\n−sij rij −sji rij 1\n\n =\n\n  \nwi − s2ij\nrij tij −\nsijsji\nrij 0\ntij − sijsji\nrij wj −\ns2ji rij 0\n0 0 rij\n\n  \nfor each edge, we have\n(Y )i,j =\n\n \n \n(1− di) 1 1−m2i + ∑ k∈Ni (rik − s2ik rik ) if i = j, tij − sijsji rij if i and j are adjacent , 0 otherwise.\nThe elements of Y are represented in terms of {mi, χij} as follows:\n(Y )i,i = 1\n1−m2i +\n∑\nk∈Ni\n(rik − s2ik rik − 1 1−m2i )\n= 1\n1−m2i +\n∑\nk∈Ni\n(χik −mimk) 2\n(1−m2i )(1 −m 2 i −m 2 k + 2mimkχik − χ 2 ik)\nand,\n(Y )i,j = tij − sijsji rij\n= −(χij −mimj)\n(1−m2i −m 2 j + 2mimjχij − χ 2 ij)\nfor adjacent i and j.\nStep2: Computation of IN + D̂ − Â From the definition (13) of uj→i, we see that\nui→juj→i 1− ui→juj→i = (χij −mimj)\n2\n(1−m2i −m 2 j + 2mimjχij − χ 2 ij)\n,\nui→j 1− ui→juj→i = (1−m2i )(χij −mimj) (1−m2i −m 2 j + 2mimjχij − χ 2 ij) .\nTherefore, the diagonal element is\n(IN + D̂ − Â)i,i = (IN + D̂)i,i = 1 + ∑\nk∈Ni\nui→kuk→i 1− ui→kuk→i\n= 1 + ∑\nk∈Ni\n(χik −mimk) 2\n(1−m2i −m 2 k + 2mimkχik − χ 2 ik)\n,\nand for adjacent i and j,\n(IN + D̂ − Â)i,j = −(Â)i,j = −uj→i\n1− ui→juj→i\n= −(1−m2j)(χij −mimj)\n(1 −m2i −m 2 j + 2mimjχij − χ 2 ij)\n.\nCombining the results of step 1 and 2, we have\nIN + D̂ − Â = Y\n\n   1−m21 0 . . . 0 0 1−m22 . . . 0 ... ... . . .\n... 0 0 . . . 1−m2N\n\n   .\nStep3: Final step We see that\nζG(u) −1 = det(I − UM) (27)\n= det(IN + D̂ − Â) ∏\n[e]∈E\n(1− ueuē) (28)\n= det(Y ) ∏\ni∈V\n(1−m2i ) ∏\n[e]∈E\n(1− ueuē)\n= det(∇2F ) ∏\ni∈V\n(1 −m2i ) ∏\nij∈E\n1− ui→juj→i rij\n= det(∇2F ) ∏\ni∈V\n(1 −m2i ) 1−di\n∏\nij∈E\n(1− ui→juj→i)(1 −m 2 i )(1 −m 2 j)\nrij . (29)\nFrom (27) to (28), we used the edge zeta version of Ihara’s formula (Theorem 2).\nFurthermore, with a straightforward computation we see that\n(1− ui→juj→i)(1 −m 2 i )(1−m 2 j )\nrij = 44\n∏\nxi,xj=±1\nbij(xi, xj),\n(1−m2i ) 1−di = 22−2di\n∏\nxi=±1\nbi(xi) 1−di ,\nwhere bij(xi, xj) = 14 (1 +mixi +mjxj + χijxixj) and bi(xi) = 1 2 (1 +mi).\nTherefore,\n(29) = 2 ∑ i∈V (2−2di)44M det(∇2F ) ∏\ni∈V\n∏\nxi=±1\nbi(xi) 1−di\n∏\nij∈E\n∏\nxi,xj=±1\nbij(xi, xj)\n= 22N+4M det(∇2F ) ∏\ni∈V\n∏\nxi=±1\nbi(xi) 1−di\n∏\nij∈E\n∏\nxi,xj=±1\nbij(xi, xj)."
    }, {
      "heading" : "C Proof of Corollary 2",
      "text" : "Here, we prove the limit formula in Corollary 2.\nProof. We can easily check that ui→j(t) = t, ∏\nij∈E\n∏\nxi,xj=±1\nbij(xi, xj) = 4 −4M (1 − t)2M (1 + t)2M , and\n∏\ni∈V\n∏\nxi=±1\nbi(xi) 1−di = 2−2N+4M\non this interval. Therefore\nlim t→1 det(∇2F (t))(1 − t)M+N−1 = lim t→1 ζG(u(t)) −1(1− t)M+N−1\n( 4−4M (1− t)2M (1 + t)2M2−2N+4M22N+4M )−1\n= lim t→1\nζG(t) −1(1− t)−M+N−12−2M\n= −(M −N)κ(G)2−M−N+1.\nOn the final equality, we used Hashimoto’s formula:\nlim u→1\nζG(u) −1(1 − u)−M+N−1 = −2M−N+1(M −N)κ(G).\nWe refer to [13, 25, 26] for this formula."
    }, {
      "heading" : "D Transformation of messages and proof of Theorem 5",
      "text" : ""
    }, {
      "heading" : "D.1 Transformation of messages",
      "text" : "First, we make an easy observation on the LBP update.\nProposition 1. Let {πi→j} be any set of messages. We define a transformation from messages {µti→j} to messages {µ̃ t i→j} by\nµ̃ti→j(xj) ∝ µti→j(xj)\nπi→j(xj) . (30)\nWe also define transformation from functions {ψij , ψi} to functions {ψ̃ij , ψ̃i} by\nψ̃ij(xi, xj) ∝ ψij(xi, xj)\nπi→j(xj)πj→i(xi) , (31)\nψ̃i(xi) ∝ ψi(xi) ∏\nk∈Ni\nπk→i(xi). (32)\nThen the update µt+1i→j(xj) ∝ ∑\nxi\nψji(xj , xi)ψi(xi) ∏\nk∈Ni\\j\nµtk→i(xi), (33)\nis equivalent to µ̃t+1i→j(xj) ∝ ∑\nxi\nψ̃ji(xj , xi)ψ̃i(xi) ∏\nk∈Ni\\j\nµ̃tk→i(xi). (34)\nProof. The equivalence of (33) and (34) is easily checked by (30), (31), and (32).\nSymbolically, Proposition 1 implies that\nΠ ◦ T ◦Π−1 = T̃ , (35)\nwhere Π is the transformation of the messages by πi→j , T is the LBP update with {ψij , ψi}, and T̃ is the LBP update with {ψ̃ij , ψ̃i} . Differentiation of this relation gives the transformation of the linearization matrix.\nIf we choose {πi→j} as πi→j(xj) = µ∞i→j(xj), then (30), (31) and (32) becomes\nµ̃ti→j(xj) ∝ µti→j(xj)\nµ∞i→j(xj) (36)\nψ̃ij(xi, xj) ∝ bij(xi, xj)\nbi(xi)bj(xj) (37)\nψ̃i(xi) ∝ bi(xi). (38)\nThis is the transformation used in the paper."
    }, {
      "heading" : "D.2 Proof of Theorem 5",
      "text" : "Proof. Let {µ∞i→j(xj)} be the set of messages at the fixed point and let Π be the transformation of messages defined by the fixed point messages. We parameterize the messages by ηti→j = µti→j(+)/µ t i→j(−). It is enough to prove the assertion after the transformation and in this parameterization, because these operations cause similar linearization matrices.\nAfter the transformation, the LBP update is given in terms of η̃ as follows:\nη̃t+1i→j =\n∑\nxi ψ̃ji(+, xi)ψ̃i(xi)\n∏\nk∈Ni\\j µ̃k→i(xi)\n∑\nxi ψ̃ji(−, xi)ψ̃i(xi)\n∏\nk∈Ni\\j µ̃k→i(xi)\n=\nbji(+,+) bj(+) ∏ k∈Ni\\j η̃k→i(xi) + bji(+,−) bj(+) bji(−,+) bj(−) ∏ k∈Ni\\j η̃k→i(xi) + bji(−,−) bj(−) .\nLet η̃∞ := Π(η∞), then η̃∞e = 1 for all e ∈ ~E. We can compute T̃ ′(η̃ ∞) as follows:\nT̃ ′(η̃∞) = ∂η̃t+1i→j ∂η̃tk→l ∣ ∣ ∣ η̃t=1\n= (bji(+,+)\nbj(+) −\nbji(−,+)\nbj(−)\n)\nMi→j,k→l\n= χij −mimj 1−m2j Mi→j,k→l.\nE Idea and proof of Theorem 7\nE.1 Idea of Theorem 7\nIn Theorem 7, we show that the sum of indexes is equal to one. This is not so special. The simplest example that illustrate the idea of the theorem is sketched in figure 4. For each stationary point, plus or minus sign is assigned depending on the sign of the second derivative. When we deform the function, the sum is still equal to one as long as the outward gradients are positive at the boundaries. (See figure 5.)\nLemma 1, combined with Lemma 2, describes the behavior of the Bethe free energy near the boundary of L(G)."
    }, {
      "heading" : "E.2 Proof of Lemma 1",
      "text" : "Proof. First, note that it is enough to prove the assertion when hi = 0 and Jij = 0.\nWe prove by contradiction. Assume that ‖∇F (qn)‖ 6→ ∞. Then, there exists R > 0 such that ‖∇F (qn)‖ ≤ R for infinitely many n. Let B0(R) be the closed ball of radius R centered at the origin. Taking subsequences, if necessary, we can assume that\n∇F (qn) → ∃\n(\nξ\nη\n)\n∈ B0(R), (39)\nbecause of the compactness of B0(R). Let b (n) ij (xi, xj) and b (n) i (xi) be the pseudomarginals corresponding to qn. Since qn → q∗ ∈ ∂L(G), there exist ij ∈ E, xi and xj such that\nb (n) ij (xi, xj) → 0.\nWithout loss of generality, we assume that xi = +1 and xj = +1. From (39), we have\n∇F (qn)ij = 1\n4 log\nb (n) ij (+,+)b (n) ij (−,−) b (n) ij (+,−)b (n) ij (−,+) −→ ηij . (40)\nTherefore b(n)ij (+,−) → 0 or b (n) ij (−,+) → 0 holds; we assume b (n) ij (+,−) → 0 without loss of generality. Now we have\nb (n) i (+) = b (n) ij (+,−) + b (n) ij (+,+) → 0.\nIn this situation, the following claim holds.\nClaim. Let k ∈ Ni. In the limit of n → ∞,\n∑\nxi,xk=±1\nxi log b (n) ik (xi, xk)\nb (n) i (xi)\n= log\n[\nb (n) ik (+,+)b (n) ik (+,−)b (n) i (−) 2 b (n) ik (−,+)b (n) ik (−,−)b (n) i (+) 2\n]\n(41)\nconverges to a finite value.\nproof of claim. From b(n)i (+) → 0, we have\nb (n) ik (+,−), b (n) ik (+,+) −→ 0 and b (n) i (−) → 1.\nCase 1: b(n)ik (−,+) −→ b ∗ ik(−,+) 6= 0 and b (n) ik (−,−) −→ b ∗ ik(−,−) 6= 0. In the same way as (40),\n∇F (qn)ik = 1\n4 log\nb (n) ik (+,+)b (n) ik (−,−) b (n) ik (+,−)b (n) ik (−,+) −→ ηik.\nTherefore b (n) ik (+,+)\nb (n) ik (+,−)\n−→ ∃r 6= 0.\nThen we see that (41) converges to a finite value.\nCase 2: b(n)ik (−,+) −→ 1 and b (n) ik (−,−) −→ 0. Similar to the case 1, we have\nb (n) ik (+,+)b (n) ik (−,−)\nb (n) ik (+,−)\n−→ ∃r 6= 0.\nTherefore b (n) ik (+,−)\nb (n) ik\n(+,+) → 0. This implies that b\n(n) i (+)\nb (n) ik\n(+,+) → 1. Then we see that (41) converges to a\nfinite value.\nCase 3: b(n)ik (−,+) −→ 0 and b (n) ik (−,−) −→ 1. Same as the case 2.\nNow let us get back to the proof of Lemma 1. We rewrite (19) as\n∇F (qn)i = 1\n2 log b\n(n) i (+)−\n1 2 log b (n) i (−) + 1 4 ∑\nk∈Ni\n∑\nxi,xk=±1\nxi log b (n) ik (xi, xk)\nb (n) i (xi)\n(42)\nFrom (39), this value converges to ξi. The second and the third terms in (42) converges to a finite value, while the first value converges to infinite. This is a contradiction."
    }, {
      "heading" : "E.3 Detailed proof of Theorem 7",
      "text" : "Proof. Define a map Φ : L(G) → RN+M by\nΦ(q)i = (1− di) 1\n2\n∑\nxi=±1\nxi log bi(xi) + 1\n4\n∑\nk∈Ni\n∑\nxi,xk=±1\nxi log bik(xi, xk), (43)\nΦ(q)ij = 1\n4\n∑\nxi,xj=±1\nxixj log bij(xi, xj), (44)\nwhere bij(xi, xj) and bi(xi) are given by q = {mi, χij} ∈ L(G). Therefore, we have ∇F = Φ− ( h\nJ\n)\nand ∇Φ = ∇2F . Then following claim holds.\nFigure 6: The graph G.\nFigure 7: The graph Ĝ.\nClaim. The sets Φ−1( ( h\nJ\n)\n),Φ−1(0) ⊂ L(G) are finite and\n∑\nq∈Φ−1( h J )\nsgn(det∇Φ(q)) = ∑\nq∈Φ−1(0)\nsgn(det∇Φ(q)), (45)\nholds.\nBefore the proof of this claim, we prove Theorem 7 under the claim.\nFrom (43) and (44), it is easy to see that Φ(q) = 0 ⇔ q = {mi = 0, χij = 0}. At this point, we can easily check that ∇Φ = ∇2F is a positive definite matrix. Therefore the right hand side of (45) is equal to one. The left hand side of (45) is equal to the left hand side of (??), because q ∈ Φ−1( (\nh J\n)\n) ⇔ ∇F (q) = 0. Then the assertion of Theorem 7 is proved.\nProof of the claim. First, we prove thatΦ−1( ( h\nJ\n)\n) = (∇F )−1(0) is a finite set. If not, we can choose\na sequence {qn} of distinct points from this set. Let L(G) be the closure of L(G). Since L(G) is compact, we can choose a subsequence that converges to some point q∗ ∈ L(G). From Lemma 1, q∗ ∈ L(G) and ∇F (q∗) = 0 hold. By the assumption in Theorem 7, we have det∇2F (q∗) 6= 0. This implies that ∇F (q) 6= 0 in some neighborhood of q∗. This is a contradiction because qn → q∗.\nSecondly, we prove the equality (45) using Lemma 2. Define a sequence of compact convex sets Cn := {q ∈ L(G)| ∑\nij∈E\n∑\nxi,xj − log bij ≤ n}, which increasingly converges to L(G). Since\nΦ−1(0) and Φ−1 ( h\nJ\n)\nare finite, they are included in Cn for sufficiently large n. Take K > 0 and ǫ > 0 to satisfy K − ǫ > ‖ (\nh J\n)\n‖. From Lemma 1, we see that Φ(∂Cn)∩B0(K) = φ for sufficiently large n. Let no be such a large number. Let Πǫ : RN+M → B0(K) be a smooth map that is identity on B0(K − ǫ), monotonically increasing on ‖x‖, and Πǫ(x) = K‖x‖x for ‖x‖ ≥ K . Then we obtain\na composition map Φ̃ := Πǫ ◦ Φ : Cn0 → B0(K) that satisfy Φ̃(∂Cn0) ⊂ ∂B0(K). By definition, we have Φ−1(0) = Φ̃−1(0) and Φ−1 (\nh J\n) = Φ̃−1 ( h J ) . Therefore, both 0 and ( h J )\nare regular values of Φ̃. From Lemma 2, we have\n∑\nq∈Φ̃−1( h J )\nsgn(det∇Φ̃(q)) = ∑\nq∈Φ̃−1(0)\nsgn(det∇Φ̃(q)).\nThen, the assertion of the claim is proved."
    }, {
      "heading" : "F Proof of Corollary 4",
      "text" : ""
    }, {
      "heading" : "F.1 Detailed proof of Example 2",
      "text" : "In this subsection we prove the assertion of Corollary 4 for the graph of Example 2, which is displayed in figure 6. The + and − signs represent that of two body interactions.\nIt is enough to check that det(I − BM) > 0 for arbitrary 0 ≤ β13, β23, β14, β34 < 1 and −1 < β12 ≤ 0. The graph Ĝ in figure 7 is obtained by erasing vertices 2 and 4 in G. To compute det(I − BM), it is enough to consider Ĝ. In fact\ndet(I − BM) = ζG(β) −1\n= ∏\np∈P\n(1− g(p)) (46)\n= ∏\np̂∈P̂\n(1− g(p̂)) (47)\n= ζĜ(β̂) −1 = det(I − B̂M̂),\nwhere β̂e1 := β12β23, β̂e2 := β13, β̂e3 := β14β34 and β̂ei = β̂ēi . The equality between (46) and (47) is obtained by the one to one correspondence between prime cycles of G and Ĝ.\nBy definition, we have\nB̂M̂ =\n\n       \n0 0 0 0 β̂e1 β̂e1 0 0 0 β̂e2 0 β̂e2 0 0 0 β̂e3 β̂e3 0 0 β̂e1 β̂e1 0 0 0\nβ̂e2 0 β̂e2 0 0 0 β̂e3 β̂e3 0 0 0 0\n\n        ,\nwhere the rows and columns are indexed by e1, e2, e3, ē1, ē2 and ē3. Then the determinant is\ndet(I − B̂M̂) = det\n\nI −\n\n 0 β̂e1 β̂e1 β̂e2 0 β̂e2 β̂e3 β̂e3 0\n\n\n\ndet\n\nI +\n\n 0 β̂e1 β̂e1 β̂e2 0 β̂e2 β̂e3 β̂e3 0\n\n\n\n\n= (1 − β̂e1 β̂e2 − β̂e1 β̂e3 − β̂e2 β̂e3 − 2β̂e1 β̂e2 β̂e3)\n(1− β̂e1 β̂e2 − β̂e1 β̂e3 − β̂e2 β̂e3 + 2β̂e1 β̂e2 β̂e3).\nSince −1 < β̂e1 ≤ 0 and 0 ≤ β̂e2 , β̂e3 < 1, we conclude that this is positive."
    }, {
      "heading" : "F.2 Other cases",
      "text" : "There are two operations on graphs that do not change the set of prime cycles. The first one is adding or removing a vertex of degree two on any edge. The second one is adding or removing an edge with a vertex of degree one. With these two operations, all graphs that have two linearly independent cycles are reduced to three types of graphs. The first type is in figure 7. The other types are in figure 8.\nUp to equivalence of interactions, all types of signs of two body interactions are listed in figure 9 except for the attractive case. We check the uniqueness for each case in order.\nCase (1): Proved in Example 2.\nCase (2): In this case,\nBM =\n\n      βe1 0 0 0 βe1 0 βe2 0 0 βe2 0 0 0 βe3 βe3 0 0 0 0 0 0 βe1 βe1 0 0 0 βe2 0 0 βe2 0 βe3 0 0 0 βe3\n\n      ,\nwhere rows and columns are labeled by e1, e2, e3, ē1, ē2 and ē3. Then the determinant is\ndet(I − BM) = (1 − βe1)(1− βe3)(1 − βe1 − βe3 + βe1βe3 − 4βe1β 2 e2βe3). (48)\nThis is positive when 0 ≤ βe1 , βe2 < 1 and −1 < βe3 ≤ 0.\nCase (3): The determinant (48) is also positive when 0 ≤ βe2 < 1 and −1 < βe1 , βe3 ≤ 0.\nCase (4): In this case,\nBM =\n\n  βe1 βe1 0 βe1 βe2 βe2 βe2 0 0 βe1 βe1 βe1 βe2 0 βe2 βe2\n\n  ,\nwhere rows and columns are labeled by e1, e2, ē1 and ē2. Then we have\ndet(I − BM) = (1− βe1)(1 − βe2)(1− βe1 − βe2 − 3βe1βe2). (49)\nThis is positive when 0 ≤ βe1 < 1 and −1 < βe2 ≤ 0.\nCase (5): The determinant (49) is positive when −1 < βe1 , βe2 ≤ 0."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2010,
    "abstractText" : "<lb>We propose a new approach to the analysis of Loopy Belief Propagation (LBP) by<lb>establishing a formula that connects the Hessian of the Bethe free energy with the<lb>edge zeta function. The formula has a number of theoretical implications on LBP.<lb>It is applied to give a sufficient condition that the Hessian of the Bethe free energy<lb>is positive definite, which shows non-convexity for graphs with multiple cycles.<lb>The formula clarifies the relation between the local stability of a fixed point of<lb>LBP and local minima of the Bethe free energy. We also propose a new approach<lb>to the uniqueness of LBP fixed point, and show various conditions of uniqueness.<lb>",
    "creator" : "LaTeX with hyperref package"
  }
}